import{d as c,e as $,z as M,h as C,o as f,w as a,b as t,a as m,m as w,V as D,k as p,c as y,l as q,q as R,x as U,A as P,u as v,B as A,C as B,n as E,y as N,D as H,F as W,E as J,t as K,G as Q}from"./index-BxuKpZ1b.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as j,a as I,b as L,c as S}from"./VCard-TkA4NB2g.js";import{V as X}from"./VTextarea-CkvC74CZ.js";import{V as T}from"./VSpacer-DH6S88JW.js";import{V as F}from"./VDialog-B11mrxhi.js";import{_ as Y}from"./delete-alert-icon-D8wzgUfY.js";import{V as Z,a as G}from"./VRow-BTIbGMxG.js";/* empty css              */const _={class:"mt-4"},h={key:0,class:"mt-4"},ee={key:1},le={__name:"review",props:{user:{type:Object,required:!0,default:()=>({id:"",email:"",name:"",phone:"",unit:"",createTime:"",review:"",reason:"",rejectReason:"",roles:[]})}},emits:["review-user"],setup(u,{emit:b}){const i=u,V=c([]),s=c({id:"",review:"",rejectReason:"",roles:[]});$(()=>{s.value.id=i.user.id,s.value.review=i.user.review,s.value.rejectReason=i.user.rejectReason,s.value.roles=i.user.roles,M.list().then(o=>{V.value=o.data})});const d=c(!1),g=b;function x(){s.value.id=i.user.id,N.review(s.value).then(()=>{g("review-user",{...s.value}),d.value=!1}).catch(o=>{alert("審核失敗，請重新整理後再試一次")})}function k(){s.value.review=i.user.review,s.value.rejectReason=i.user.rejectReason,s.value.unit=i.user.unit,s.value.roles=i.user.roles,d.value=!1}return(o,l)=>(f(),C(F,{modelValue:v(d),"onUpdate:modelValue":l[9]||(l[9]=e=>E(d)?d.value=e:null),"max-width":"500"},{activator:a(({props:e})=>[t(w,B(e,{title:"審核狀態",size:"small",color:"warning",text:"審核"}),null,16)]),default:a(({isActive:e})=>[t(j,{class:"review-border"},{default:a(()=>[t(I,{class:"d-flex justify-space-between align-center"},{default:a(()=>[l[11]||(l[11]=m("span",{class:"text-blue"},"審核狀態",-1)),t(w,{icon:"",variant:"text",onClick:l[0]||(l[0]=n=>k())},{default:a(()=>[t(D,null,{default:a(()=>[...l[10]||(l[10]=[p("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),t(L,null,{default:a(()=>[t(R,{"hide-details":"auto",modelValue:u.user.email,"onUpdate:modelValue":l[1]||(l[1]=n=>u.user.email=n),density:"compact",label:"帳號/信箱","prepend-inner-icon":"mdi-email",variant:"solo",required:"",class:"mb-5",readonly:""},{label:a(()=>[...l[12]||(l[12]=[p(" 帳號/信箱 ",-1)])]),_:1},8,["modelValue"]),t(R,{"hide-details":"auto",modelValue:u.user.name,"onUpdate:modelValue":l[2]||(l[2]=n=>u.user.name=n),density:"compact",label:"使用者名稱","prepend-inner-icon":"mdi-account",variant:"solo",required:"",class:"mb-5",readonly:""},{label:a(()=>[...l[13]||(l[13]=[p(" 使用者名稱 ",-1)])]),_:1},8,["modelValue"]),t(R,{"hide-details":"auto",modelValue:u.user.unit,"onUpdate:modelValue":l[3]||(l[3]=n=>u.user.unit=n),density:"compact",label:"單位","prepend-inner-icon":"mdi-domain",variant:"solo",required:"",class:"mb-5",readonly:""},{label:a(()=>[...l[14]||(l[14]=[p(" 單位 ",-1)])]),_:1},8,["modelValue"]),m("div",null,[l[15]||(l[15]=m("strong",null,"申請原因:",-1)),p(" "+U(u.user.reason),1)]),m("div",null,[l[16]||(l[16]=m("strong",null,"申請時間:",-1)),p(" "+U(u.user.createTime),1)]),m("div",_,[l[19]||(l[19]=m("strong",null,"審核狀態:",-1)),t(P,{class:"mx-4",modelValue:v(s).review,"onUpdate:modelValue":l[4]||(l[4]=n=>v(s).review=n),mandatory:""},{default:a(()=>[t(w,{class:"review-button mx-4",value:"啟用",color:"success",variant:"tonal"},{default:a(()=>[...l[17]||(l[17]=[p("啟用",-1)])]),_:1}),t(w,{class:"review-button mx-4",value:"退件",color:"error",variant:"tonal"},{default:a(()=>[...l[18]||(l[18]=[p("退件",-1)])]),_:1})]),_:1},8,["modelValue"])]),v(s).review==="退件"?(f(),y("div",h,[t(X,{modelValue:v(s).rejectReason,"onUpdate:modelValue":l[5]||(l[5]=n=>v(s).rejectReason=n),label:"退件原因",density:"compact",variant:"solo",required:"",placeholder:"請輸入退件原因"},null,8,["modelValue"])])):q("",!0),v(s).review==="啟用"?(f(),y("div",ee,[t(A,{modelValue:v(s).roles,"onUpdate:modelValue":l[6]||(l[6]=n=>v(s).roles=n),items:v(V),"item-title":"name","item-value":"id",label:"角色",variant:"underlined",chips:"",multiple:""},null,8,["modelValue","items"])])):q("",!0)]),_:1}),t(S,null,{default:a(()=>[t(T),t(w,{text:"取消",variant:"outlined",color:"grey-darken-2",onClick:l[7]||(l[7]=n=>k())}),t(w,{text:"確認",variant:"outlined",color:"primary",onClick:l[8]||(l[8]=n=>x())})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},te=z(le,[["__scopeId","data-v-df36a8da"]]),ae={class:"mt-4"},se={key:0},re={key:1},ne={__name:"edit",props:{user:{type:Object,required:!0,default:()=>({id:"",email:"",name:"",phone:"",unit:"",createTime:"",review:"",reason:"",rejectReason:"",roles:[]})}},emits:["edit-user"],setup(u,{emit:b}){const i=u,V=c([]),s=c({id:"",review:"",roles:[]});$(()=>{s.value.id=i.user.id,s.value.review=i.user.review,s.value.roles=i.user.roles,M.list().then(l=>{V.value=l.data})});const d=c(!1),g=b;function x(){N.edit(s.value).then(()=>{g("edit-user",{...s.value}),d.value=!1}).catch(l=>{alert("編輯失敗，請重新整理後再試一次"),d.value=!1})}function k(){s.value.review=i.user.review,s.value.unit=i.user.unit,s.value.roles=i.user.roles,d.value=!1}function o(){s.value.review=s.value.review=="停用"?"啟用":"停用"}return(l,e)=>(f(),C(F,{modelValue:v(d),"onUpdate:modelValue":e[8]||(e[8]=n=>E(d)?d.value=n:null),"max-width":"500"},{activator:a(({props:n})=>[t(w,B(n,{title:"編輯",icon:"mdi-pencil",size:"small",variant:"text"}),null,16)]),default:a(({isActive:n})=>[t(j,{class:"review-border"},{default:a(()=>[t(I,{class:"d-flex justify-space-between align-center"},{default:a(()=>[e[10]||(e[10]=m("span",{class:"text-blue"},"編輯人員",-1)),t(w,{icon:"",variant:"text",onClick:e[0]||(e[0]=r=>k())},{default:a(()=>[t(D,null,{default:a(()=>[...e[9]||(e[9]=[p("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),t(L,null,{default:a(()=>[t(R,{"hide-details":"auto",modelValue:u.user.email,"onUpdate:modelValue":e[1]||(e[1]=r=>u.user.email=r),density:"compact",label:"帳號/信箱","prepend-inner-icon":"mdi-email",variant:"solo",required:"",class:"mb-5",readonly:""},{label:a(()=>[...e[11]||(e[11]=[p(" 帳號/信箱 ",-1)])]),_:1},8,["modelValue"]),t(R,{"hide-details":"auto",modelValue:u.user.name,"onUpdate:modelValue":e[2]||(e[2]=r=>u.user.name=r),density:"compact",label:"使用者名稱","prepend-inner-icon":"mdi-account",variant:"solo",required:"",class:"mb-5",readonly:""},{label:a(()=>[...e[12]||(e[12]=[p(" 使用者名稱 ",-1)])]),_:1},8,["modelValue"]),t(R,{"hide-details":"auto",modelValue:u.user.unit,"onUpdate:modelValue":e[3]||(e[3]=r=>u.user.unit=r),density:"compact",label:"單位","prepend-inner-icon":"mdi-domain",variant:"solo",required:"",class:"mb-5",readonly:""},{label:a(()=>[...e[13]||(e[13]=[p(" 單位 ",-1)])]),_:1},8,["modelValue"]),m("div",ae,[e[16]||(e[16]=m("strong",null,"狀態:",-1)),t(w,{class:"review-button-edit mx-4",color:v(s).review==="啟用"?"success":"error",variant:"tonal",onClick:e[4]||(e[4]=r=>o())},{default:a(()=>[v(s).review==="啟用"?(f(),y("span",se,[...e[14]||(e[14]=[m("span",{class:"review-button-content"},"啟用",-1),m("span",{class:"review-button-circle"},"●",-1)])])):(f(),y("span",re,[...e[15]||(e[15]=[m("span",{class:"review-button-circle"},"●",-1),m("span",{class:"review-button-content"},"停用",-1)])]))]),_:1},8,["color"])]),t(A,{modelValue:v(s).roles,"onUpdate:modelValue":e[5]||(e[5]=r=>v(s).roles=r),items:v(V),"item-title":"name","item-value":"id",label:"角色",variant:"underlined",chips:"",multiple:""},null,8,["modelValue","items"])]),_:1}),t(S,null,{default:a(()=>[t(T),t(w,{text:"取消",variant:"outlined",color:"grey-darken-2",onClick:e[6]||(e[6]=r=>k())}),t(w,{text:"確認",variant:"outlined",color:"primary",onClick:e[7]||(e[7]=r=>x())})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ie=z(ne,[["__scopeId","data-v-d268f4ea"]]),oe={__name:"delete",props:{user:{type:Object,required:!0,default:()=>({id:"",email:"",name:"",phone:"",unit:"",createTime:"",review:"",reason:"",rejectReason:"",roles:[]})}},emits:["delete-user"],setup(u,{emit:b}){const i=u,V=b,s=c({id:"",review:"",unit:"",roles:[]});$(()=>{s.value.review=i.user.review,s.value.unit=i.user.unit,s.value.roles=i.user.roles});const d=c(!1);function g(){V("delete-user",i.user.id),d.value=!1}function x(){d.value=!1}return(k,o)=>(f(),C(F,{modelValue:v(d),"onUpdate:modelValue":o[3]||(o[3]=l=>E(d)?d.value=l:null),"max-width":"500"},{activator:a(({props:l})=>[t(w,B(l,{title:"刪除",icon:"mdi-trash-can",size:"small",variant:"text"}),null,16)]),default:a(({isActive:l})=>[t(j,null,{default:a(()=>[t(I,{class:"d-flex justify-space-between align-center"},{default:a(()=>[o[5]||(o[5]=m("span",{class:"text-blue"},null,-1)),t(w,{icon:"",variant:"text",onClick:o[0]||(o[0]=e=>x())},{default:a(()=>[t(D,null,{default:a(()=>[...o[4]||(o[4]=[p("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),t(L,null,{default:a(()=>[...o[6]||(o[6]=[m("div",{class:"delete-info"},[m("img",{src:Y,alt:"Delete Alert Icon",class:"delete-alert"}),m("span",null,[p("是否確認"),m("span",{class:"text-red"},"刪除"),p("?")])],-1)])]),_:1}),t(S,{class:"d-flex justify-center mb-5"},{default:a(()=>[t(w,{text:"取消",variant:"outlined",color:"grey-darken-2",onClick:o[1]||(o[1]=e=>x())}),t(T,{style:{flex:"0.25"}}),t(w,{text:"確認",variant:"outlined",color:"primary",onClick:o[2]||(o[2]=e=>g())})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ue=z(oe,[["__scopeId","data-v-e7c48700"]]),de={key:1,style:{color:"red"}},me={key:2,style:{color:"green"}},ve={key:3,style:{color:"gray"}},fe={key:4},Ue={__name:"list",setup(u){const b=c([]);$(()=>{l()});const i=c(""),V=c(""),s=H(()=>b.value.filter(e=>{const n=!i.value||e.name&&e.name.includes(i.value)||e.userName&&e.userName.includes(i.value)||e.email&&e.email.includes(i.value),r=!V.value||e.roles&&e.roles.includes(V.value);return n&&r}).sort((e,n)=>e.review==="待審核"&&n.review!=="待審核"?-1:e.review!=="待審核"&&n.review==="待審核"?1:new Date(n.createTime)-new Date(e.createTime))),d=c([{title:"使用者",key:"name"},{title:"帳號/E-mail",key:"email"},{title:"角色",key:"role"},{title:"單位",key:"unit"},{title:"狀態",key:"review",sortable:!1},{title:"編輯",key:"edit",sortable:!1},{title:"刪除",key:"delete",sortable:!1}]),g=c(["一般使用者","管理員","測試人員","師父","徒弟"]);c(),c({name:"",email:"",unit:"",phone:"",reason:""});function x(){l()}function k(){l()}function o(){l()}function l(){N.list().then(e=>{b.value=e.data})}return(e,n)=>(f(),y(W,null,[t(Z,{class:"mt-1"},{default:a(()=>[t(G,{cols:"4"},{default:a(()=>[t(A,{label:"角色篩選",modelValue:V.value,"onUpdate:modelValue":n[0]||(n[0]=r=>V.value=r),items:g.value,variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),t(T),t(G,{cols:"4"},{default:a(()=>[t(R,{label:"搜尋",modelValue:i.value,"onUpdate:modelValue":n[1]||(n[1]=r=>i.value=r),density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1})]),_:1}),t(j,{class:"rounded-lg elevation-3"},{default:a(()=>[t(J,{headers:d.value,items:s.value,density:"comfortable",class:"cyan-header"},{"item.role":a(({item:r})=>[(f(!0),y(W,null,K(r.roles,O=>(f(),C(Q,{key:O,class:"ma-1",color:"primary","text-color":"white",size:"small"},{default:a(()=>[p(U(O.name),1)]),_:2},1024))),128))]),"item.review":a(({item:r})=>[r.review==="待審核"?(f(),C(te,{key:0,user:r,onReviewUser:x},null,8,["user"])):r.review==="退件"?(f(),y("span",de,U(r.review),1)):r.review==="啟用"?(f(),y("span",me,U(r.review),1)):r.review==="停用"?(f(),y("span",ve,U(r.review),1)):(f(),y("span",fe,U(r.review),1))]),"item.edit":a(({item:r})=>[r.review!=="待審核"?(f(),C(ie,{key:0,user:r,onEditUser:k},null,8,["user"])):q("",!0)]),"item.delete":a(({item:r})=>[t(ue,{user:r,onDeleteUser:o},null,8,["user"])]),_:1},8,["headers","items"])]),_:1})],64))}};export{Ue as default};
