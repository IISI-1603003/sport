import{R as B,f as m,h as R,i as V,j as U,w as a,k,r as N,o as b,d as e,e as o,l as g,V as v,m as l,u as s,v as x,b as _,n as q,p as y}from"./index-Bz3xUFWk.js";import{a as A}from"./auth-B3LXPdSC.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as M}from"./VForm-C7V5gtkH.js";const S={class:"d-flex align-center ga-3"},T={class:"d-flex align-center ga-3"},$={class:"d-flex align-center ga-3"},E=["src"],j={class:"or-container"},F={__name:"index",setup(P){const{signIn:w}=A(),{executeRecaptcha:C}=B.useReCaptcha(),u=m(!1),r=m({username:"iisi-admin",p:"Tiss2025@dmin!@#"}),c=m(),i=m({guid:null,code:1});R(async()=>{f()});const f=async()=>{let{data:p}=await V.captcha(),t=btoa(new Uint8Array(p).reduce((d,n)=>d+String.fromCharCode(n),""));c.value=`data:image/png;base64,${t}`},I=async()=>{if(u.value)return;u.value=!0;const p=await C("signIn");V.signIn(r.value,{headers:{token:p,code:i.value.code}}).then(t=>{w(t.data)}).catch(t=>{alert(t.response.data||"系統異常，請稍後再試。"),f()}).finally(()=>{u.value=!1})};return(p,t)=>{const d=N("router-link");return b(),U(M,{onSubmit:k(I,["prevent"])},{default:a(()=>[t[13]||(t[13]=e("h2",{class:"text-center"},"登入",-1)),e("div",S,[o(v,null,{default:a(()=>[...t[5]||(t[5]=[l("mdi-account",-1)])]),_:1}),g(e("input",{type:"text",class:"input",required:"","onUpdate:modelValue":t[0]||(t[0]=n=>s(r).username=n)},null,512),[[x,s(r).username]])]),e("div",T,[o(v,null,{default:a(()=>[...t[6]||(t[6]=[l("mdi-lock",-1)])]),_:1}),g(e("input",{type:"password",class:"input",required:"","onUpdate:modelValue":t[1]||(t[1]=n=>s(r).p=n)},null,512),[[x,s(r).p]])]),o(d,{to:"/sign-in/forget",class:"float-right text-decoration-none"},{default:a(()=>[...t[7]||(t[7]=[l(" 忘記密碼 ",-1)])]),_:1}),t[14]||(t[14]=e("br",null,null,-1)),e("div",$,[g(e("input",{id:"captcha",ref:"captchaRef",type:"text","onUpdate:modelValue":t[2]||(t[2]=n=>s(i).code=n),onInput:t[3]||(t[3]=n=>s(i).code=s(i).code.toUpperCase()),placeholder:"輸入驗證碼",class:"input input-bordered flex-grow-1",required:""},null,544),[[x,s(i).code]]),s(c)?(b(),_("img",{key:0,src:s(c),alt:"captcha",class:"ga-3",style:{"max-width":"150px"}},null,8,E)):q("",!0),o(v,{onClick:t[4]||(t[4]=k(n=>f(),["prevent"]))},{default:a(()=>[...t[8]||(t[8]=[l("mdi-refresh",-1)])]),_:1})]),o(y,{type:"submit",variant:"flat",color:"primary",block:"",class:"mt-5",loading:s(u)},{default:a(()=>[...t[9]||(t[9]=[l(" 登入 ",-1)])]),_:1},8,["loading"]),t[15]||(t[15]=e("div",{class:"or"},"或",-1)),e("div",j,[o(y,{color:"secondary",class:"or-item my-1"},{default:a(()=>[o(d,{to:"/sign-in/register",class:"text-decoration-none"},{default:a(()=>[...t[10]||(t[10]=[l(" 一般帳號註冊 ",-1)])]),_:1})]),_:1}),t[12]||(t[12]=e("div",{class:"ml-3"},null,-1)),o(y,{color:"success",class:"or-item my-1"},{default:a(()=>[o(d,{to:"/sign-in/registerAD",class:"text-decoration-none"},{default:a(()=>[...t[11]||(t[11]=[l(" AD帳號註冊 ",-1)])]),_:1})]),_:1})])]),_:1})}}},K=D(F,[["__scopeId","data-v-e648d328"]]);export{K as default};
