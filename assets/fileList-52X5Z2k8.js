import{T as ue,E as C,U as xe,W as _e,X as Ae,Y as de,Z as Pe,_ as ae,f as V,$ as Re,a0 as $e,M as ze,a1 as je,a2 as Ee,a3 as ne,a4 as ie,e as i,D as Z,a5 as Le,a6 as Me,a7 as Ne,d as B,F as R,a8 as Ue,a9 as Oe,H as ce,aa as Ye,ab as He,h as Ge,b as N,w as s,u as g,r as We,p as U,o as b,j as O,B as q,m as h,V as oe,z as Ke,t as I,s as Xe,n as D,ac as Ze}from"./index-DsLPX3BI.js";import{_ as qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as se,a as P}from"./VRow-NzVItThu.js";import{V as Je}from"./VDialog-nugxKd2C.js";import{V as Qe,a as re}from"./VBreadcrumbs-QvdAviYs.js";import{V as et}from"./VCheckbox-C4HdV1oL.js";import{V as tt,a as lt,b as at,c as nt}from"./VCard-CL4EWFtp.js";import{V as it}from"./VSpacer-C1XAD_mX.js";/* empty css              */function ot(){function e(f){return[...f.dataTransfer?.items??[]].filter(r=>r.kind==="file").map(r=>r.webkitGetAsEntry()).filter(Boolean).length>0||[...f.dataTransfer?.files??[]].length>0}async function c(f){const u=[],r=[...f.dataTransfer?.items??[]].filter(a=>a.kind==="file").map(a=>a.webkitGetAsEntry()).filter(Boolean);if(r.length)for(const a of r){const v=await fe(a,me(".",a));u.push(...v.map(d=>d.file))}else u.push(...f.dataTransfer?.files??[]);return u}return{handleDrop:c,hasFilesOrFolders:e}}function fe(e){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return new Promise((f,u)=>{e.isFile?e.file(a=>f([{file:a,path:c}]),u):e.isDirectory&&e.createReader().readEntries(async a=>{const v=[];for(const d of a)v.push(...await fe(d,me(c,d)));f(v)})})}function me(e,c){return c.isDirectory?`${e}/${c.name}`:e}const st=ue({filterByType:String},"file-accept");function rt(e){const c=C(()=>e.filterByType?ut(e.filterByType):null);function f(u){if(c.value){const r=u.filter(c.value);return{accepted:r,rejected:u.filter(a=>!r.includes(a))}}return{accepted:u,rejected:[]}}return{filterAccepted:f}}function ut(e){const c=e.split(",").map(a=>a.trim().toLowerCase()),f=c.filter(a=>a.startsWith(".")),u=c.filter(a=>a.endsWith("/*")),r=c.filter(a=>!f.includes(a)&&!u.includes(a));return a=>{const v=a.name.split(".").at(-1)?.toLowerCase()??"",d=a.type.split("/").at(0)?.toLowerCase()??"";return r.includes(a.type)||f.includes(`.${v}`)||u.includes(`${d}/*`)}}const dt=ue({chips:Boolean,counter:Boolean,counterSizeString:{type:String,default:"$vuetify.fileInput.counterSize"},counterString:{type:String,default:"$vuetify.fileInput.counter"},hideInput:Boolean,multiple:Boolean,showSize:{type:[Boolean,Number,String],default:!1,validator:e=>typeof e=="boolean"||[1e3,1024].includes(Number(e))},truncateLength:{type:[Number,String],default:22},...Ne({prependIcon:"$file"}),modelValue:{type:[Array,Object],default:e=>e.multiple?[]:null,validator:e=>de(e).every(c=>c!=null&&typeof c=="object")},...st(),...Me({clearable:!0})},"VFileInput"),ct=xe()({name:"VFileInput",inheritAttrs:!1,props:dt(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0,rejected:e=>!0},setup(e,c){let{attrs:f,emit:u,slots:r}=c;const{t:a}=_e(),{filterAccepted:v}=rt(e),d=Ae(e,"modelValue",e.modelValue,t=>de(t),t=>!e.multiple&&Array.isArray(t)?t[0]:t),{isFocused:m,focus:S,blur:Y}=Pe(e),$=C(()=>typeof e.showSize!="boolean"?e.showSize:void 0),z=C(()=>(d.value??[]).reduce((t,p)=>{let{size:T=0}=p;return t+T},0)),j=C(()=>ae(z.value,$.value)),x=C(()=>(d.value??[]).map(t=>{const{name:p="",size:T=0}=t,w=ve(p);return e.showSize?`${w} (${ae(T,$.value)})`:w})),H=C(()=>{const t=d.value?.length??0;return e.showSize?a(e.counterSizeString,t,j.value):a(e.counterString,t)}),E=V(),L=V(),y=V(),G=Re(()=>m.value||e.active),M=C(()=>["plain","underlined"].includes(e.variant)),F=$e(!1),{handleDrop:n,hasFilesOrFolders:l}=ot();function _(){y.value!==document.activeElement&&y.value?.focus(),m.value||S()}function o(t){y.value?.click()}function k(t){u("mousedown:control",t)}function J(t){y.value?.click(),u("click:control",t)}function pe(t){t.stopPropagation(),_(),Ye(()=>{d.value=[],He(e["onClick:clear"],t)})}function ve(t){if(t.length<Number(e.truncateLength))return t;const p=Math.floor((Number(e.truncateLength)-1)/2);return`${t.slice(0,p)}…${t.slice(t.length-p)}`}function ye(t){t.preventDefault(),t.stopImmediatePropagation(),F.value=!0}function ge(t){t.preventDefault(),F.value=!1}async function he(t){if(t.preventDefault(),t.stopImmediatePropagation(),F.value=!1,!y.value||!l(t))return;const p=await n(t);Q(p)}function ke(t){if(!(!t.target||t.repack))if(e.filterByType)Q([...t.target.files]);else{const p=t.target;d.value=[...p.files??[]]}}function Q(t){const p=new DataTransfer,{accepted:T,rejected:w}=v(t);w.length&&u("rejected",w);for(const K of T)p.items.add(K);y.value.files=p.files,d.value=[...p.files];const W=new Event("change",{bubbles:!0});W.repack=!0,y.value.dispatchEvent(W)}return ze(d,t=>{(!Array.isArray(t)||!t.length)&&y.value&&(y.value.value="")}),je(()=>{const t=!!(r.counter||e.counter),p=!!(t||r.details),[T,w]=Ee(f),{modelValue:W,...K}=ne.filterProps(e),Ve={...ie.filterProps(e),"onClick:clear":pe},Ce=f.webkitdirectory!==void 0&&f.webkitdirectory!==!1,be=f.accept?String(f.accept):void 0,Fe=Ce?void 0:e.filterByType??be;return i(ne,Z({ref:E,modelValue:e.multiple?d.value:d.value[0],class:["v-file-input",{"v-file-input--chips":!!e.chips,"v-file-input--dragging":F.value,"v-file-input--hide":e.hideInput,"v-input--plain-underlined":M.value},e.class],style:e.style,"onClick:prepend":o},T,K,{centerAffix:!M.value,focused:m.value}),{...r,default:X=>{let{id:Te,isDisabled:ee,isDirty:te,isReadonly:le,isValid:we,hasDetails:De}=X;return i(ie,Z({ref:L,prependIcon:e.prependIcon,onMousedown:k,onClick:J,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},Ve,{id:Te.value,active:G.value||te.value,dirty:te.value||e.dirty,disabled:ee.value,focused:m.value,details:De.value,error:we.value===!1,onDragover:ye,onDrop:he}),{...r,default:Be=>{let{props:{class:Ie,...Se}}=Be;return B(R,null,[B("input",Z({ref:y,type:"file",accept:Fe,readonly:le.value,disabled:ee.value,multiple:e.multiple,name:e.name,onClick:A=>{A.stopPropagation(),le.value&&A.preventDefault(),_()},onChange:ke,onDragleave:ge,onFocus:_,onBlur:Y},Se,w),null),B("div",{class:Oe(Ie)},[!!d.value?.length&&!e.hideInput&&(r.selection?r.selection({fileNames:x.value,totalBytes:z.value,totalBytesReadable:j.value}):e.chips?x.value.map(A=>i(ce,{key:A,size:"small",text:A},null)):x.value.join(", "))])])}})},details:p?X=>B(R,null,[r.details?.(X),t&&B(R,null,[B("span",null,null),i(Ue,{active:!!d.value?.length,value:H.value,disabled:e.disabled},r.counter)])]):void 0})}),Le({},E,L,y)}}),ft={class:"d-flex align-center"},mt=["onClick"],pt={key:1},vt={__name:"fileList",setup(e){const c=[{id:1,name:"BASE_CD(資訊處)",type:"folder",updateTime:"2025-09-30 12:23"},{id:2,name:"BU(實務處)",type:"folder",updateTime:"2025-10-01 08:45"},{id:3,name:"ED(企發處)",type:"folder",updateTime:"2025-10-02 14:30"}],f={1:[{id:11,name:"生電組成.csv",type:"csv",status:"待處理",updateTime:"2025-09-30 12:23"},{id:12,name:"醫男監任.csv",type:"csv",status:"處理中",updateTime:"2025-10-01 08:45"},{id:13,name:"度為畫表.csv",type:"csv",status:"異常資料",updateTime:"2025-10-02 14:30"},{id:14,name:"訓練量分析.csv",type:"csv",status:"已處理",updateTime:"2025-10-03 09:15"},{id:15,name:"心率學異.csv",type:"csv",status:"已處理",updateTime:"2025-10-04 13:00"},{id:16,name:"運動日誌.csv",type:"csv",status:"已處理",updateTime:"2025-10-05 11:45"},{id:17,name:"身體狀態評估.csv",type:"csv",status:"已處理",updateTime:"2025-10-06 16:10"},{id:18,name:"營養攝取記錄.csv",type:"csv",status:"已處理",updateTime:"2025-10-07 10:30"}]},u=V(c),r=V(!1),a=V(""),v=V(!1),d=V([]),m=V([]),S=V([]),Y=C(()=>{const n=[{title:"序號",key:"id",sortable:!0,width:"120px"},{title:"檔案",key:"name",sortable:!0}];return m.value.length>0&&n.push({title:"處理狀態",key:"status",sortable:!0,width:"120px"}),n.push({title:"異動時間",key:"updateTime",sortable:!0,width:"200px"},{title:"編輯",key:"edit",sortable:!1,width:"80px",align:"center"},{title:"刪除",key:"delete",sortable:!1,width:"80px",align:"center"}),n}),$=C(()=>{let n=u.value;return a.value&&(n=n.filter(l=>l.name.toLowerCase().includes(a.value.toLowerCase()))),n}),z=n=>({folder:"mdi-folder",csv:"mdi-file-delimited",image:"mdi-file-image",document:"mdi-file-document",video:"mdi-file-video",audio:"mdi-file-music",archive:"mdi-file-archive"})[n]||"mdi-file",j=n=>({待處理:"orange",處理中:"blue",已處理:"green",異常資料:"red"})[n]||"grey",x=n=>{m.value.push(n.name),f[n.id]?u.value=f[n.id]:u.value=[]},H=()=>{m.value=[],u.value=c},E=n=>{m.value=m.value.slice(0,n+1)},L=()=>{m.value.length>0&&(m.value.pop(),m.value.length===0&&(u.value=c))},y=n=>{console.log("編輯檔案:",n)},G=async n=>{try{u.value=u.value.filter(l=>l.id!==n.id),console.log("刪除檔案:",n)}catch(l){console.error("刪除檔案失敗:",l)}},M=async()=>{if(!(!d.value||d.value.length===0))try{v.value=!1,d.value=[],F()}catch(n){console.error("上傳檔案失敗:",n)}},F=async()=>{r.value=!0;try{console.log("載入檔案清單")}catch(n){console.error("載入檔案清單失敗:",n)}finally{r.value=!1}};return Ge(()=>{F()}),(n,l)=>{const _=We("l-data-table");return b(),N(R,null,[i(se,null,{default:s(()=>[i(P,{cols:"12"},{default:s(()=>[g(m).length>0?(b(),O(Qe,{key:0,class:"pa-0 mb-4"},{default:s(()=>[i(re,{onClick:H},{default:s(()=>[i(oe,null,{default:s(()=>[...l[6]||(l[6]=[h("mdi-home",-1)])]),_:1}),l[7]||(l[7]=h(" 根目錄 ",-1))]),_:1}),(b(!0),N(R,null,Ke(g(m),(o,k)=>(b(),O(re,{key:k,onClick:J=>E(k),disabled:k===g(m).length-1},{default:s(()=>[h(I(o),1)]),_:2},1032,["onClick","disabled"]))),128))]),_:1})):q("",!0)]),_:1})]),_:1}),i(se,null,{default:s(()=>[i(P,{cols:"12",md:"6"},{default:s(()=>[i(Xe,{modelValue:g(a),"onUpdate:modelValue":l[0]||(l[0]=o=>U(a)?a.value=o:null),"prepend-inner-icon":"mdi-magnify",label:"搜尋",variant:"outlined",density:"compact","append-inner-icon":"mdi-magnify"},null,8,["modelValue"])]),_:1}),i(P,{cols:"12",md:"2"},{default:s(()=>[i(D,{color:"primary",variant:"outlined"},{default:s(()=>[...l[8]||(l[8]=[h("搜尋",-1)])]),_:1})]),_:1}),g(m).length>0?(b(),O(P,{key:0,cols:"12",md:"2"},{default:s(()=>[i(D,{color:"secondary",variant:"outlined",onClick:L},{default:s(()=>[...l[9]||(l[9]=[h(" 返回上層 ",-1)])]),_:1})]),_:1})):q("",!0),i(P,{cols:"12",md:g(m).length>0?2:4,class:"d-flex justify-end"},{default:s(()=>[i(D,{color:"success","prepend-icon":"mdi-plus",onClick:l[1]||(l[1]=o=>v.value=!0)},{default:s(()=>[...l[10]||(l[10]=[h(" 新增 ",-1)])]),_:1})]),_:1},8,["md"])]),_:1}),i(_,{headers:g(Y),items:g($),loading:g(r),"item-key":"id"},{"item.selected":s(({item:o})=>[o.type!=="folder"?(b(),O(et,{key:0,modelValue:g(S),"onUpdate:modelValue":l[2]||(l[2]=k=>U(S)?S.value=k:null),value:o.id,"hide-details":""},null,8,["modelValue","value"])):q("",!0)]),"item.name":s(({item:o})=>[B("div",ft,[i(oe,{class:"me-2",color:"primary"},{default:s(()=>[h(I(z(o.type)),1)]),_:2},1024),o.type==="folder"?(b(),N("span",{key:0,class:"text-primary cursor-pointer",onClick:k=>x(o)},I(o.name),9,mt)):(b(),N("span",pt,I(o.name),1))])]),"item.status":s(({item:o})=>[i(ce,{color:j(o.status),size:"small",variant:"flat"},{default:s(()=>[h(I(o.status),1)]),_:2},1032,["color"])]),"item.updateTime":s(({item:o})=>[h(I(("dayjs"in n?n.dayjs:g(Ze))(o.updateTime).format("YYYY-MM-DD HH:mm")),1)]),"item.edit":s(({item:o})=>[i(D,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:k=>y(o)},null,8,["onClick"])]),"item.delete":s(({item:o})=>[i(D,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:k=>G(o)},null,8,["onClick"])]),_:1},8,["headers","items","loading"]),i(Je,{modelValue:g(v),"onUpdate:modelValue":l[5]||(l[5]=o=>U(v)?v.value=o:null),"max-width":"500px"},{default:s(()=>[i(tt,null,{default:s(()=>[i(lt,null,{default:s(()=>[...l[11]||(l[11]=[h("上傳檔案",-1)])]),_:1}),i(at,null,{default:s(()=>[i(ct,{modelValue:g(d),"onUpdate:modelValue":l[3]||(l[3]=o=>U(d)?d.value=o:null),label:"選擇檔案",multiple:"",variant:"outlined","prepend-icon":"mdi-paperclip"},null,8,["modelValue"])]),_:1}),i(nt,null,{default:s(()=>[i(it),i(D,{text:"",onClick:l[4]||(l[4]=o=>v.value=!1)},{default:s(()=>[...l[12]||(l[12]=[h("取消",-1)])]),_:1}),i(D,{color:"primary",onClick:M},{default:s(()=>[...l[13]||(l[13]=[h("上傳",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}}},wt=qe(vt,[["__scopeId","data-v-ab1fe311"]]);export{wt as default};
