import{ay as K,T as U,E as Q,U as Y,X as Z,$ as T,az as h,aA as ee,aB as ae,aC as le,aD as se,aE as te,aF as oe,aG as ne,aH as re,W as ie,e as a,aI as B,a9 as I,aJ as ue,aK as de,aL as ce,aM as me,aN as fe,aO as ve,aP as ye,aQ as Ve,aR as pe,aS as we,aT as Pe,aU as ke,d as V,V as $,D as L,ao as A,n as x,f as y,j as S,w as s,o as C,m as u,p as be,u as o,B as D,s as g,t as F,aV as Se,aW as w,aX as P,a as Ce}from"./index-DsLPX3BI.js";import{V as ge}from"./VContainer-BYFrOza9.js";import{V as xe,a as ze}from"./VRow-NzVItThu.js";import{V as M,a as _e,b as N,c as Te,e as Be}from"./VCard-CL4EWFtp.js";import{V as Ie}from"./VForm-DeEXvWx8.js";import{V as Le}from"./VSpacer-C1XAD_mX.js";/* empty css              */const Ae=K("v-alert-title"),De=U({iconSize:[Number,String],iconSizes:{type:Array,default:()=>[["x-small",10],["small",16],["default",24],["large",28],["x-large",32]]}},"iconSize");function Fe(e,v){return{iconSize:Q(()=>{const t=new Map(e.iconSizes),n=e.iconSize??v()??"default";return t.has(n)?t.get(n):n})}}const Me=["success","info","warning","error"],Ne=U({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:Pe,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>Me.includes(e)},...we(),...pe(),...Ve(),...ye(),...De(),...ve(),...fe(),...me(),...ce(),...de(),...ue({variant:"flat"})},"VAlert"),R=Y()({name:"VAlert",props:Ne(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,v){let{emit:m,slots:t}=v;const n=Z(e,"modelValue"),d=T(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),{iconSize:r}=Fe(e,()=>e.prominent?44:void 0),{themeClasses:f}=h(e),{colorClasses:k,colorStyles:p,variantClasses:i}=ee(()=>({color:e.color??e.type,variant:e.variant})),{densityClasses:l}=ae(e),{dimensionStyles:c}=le(e),{elevationClasses:q}=se(e),{locationStyles:E}=te(e),{positionClasses:O}=oe(e),{roundedClasses:j}=ne(e),{textColorClasses:W,textColorStyles:X}=re(()=>e.borderColor),{t:G}=ie(),z=T(()=>({"aria-label":G(e.closeLabel),onClick(b){n.value=!1,m("click:close",b)}}));return()=>{const b=!!(t.prepend||d.value),H=!!(t.title||e.title),J=!!(t.close||e.closable),_={density:e.density,icon:d.value,size:e.iconSize||e.prominent?r.value:void 0};return n.value&&a(e.tag,{class:I(["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},f.value,k.value,l.value,q.value,O.value,j.value,i.value,e.class]),style:B([p.value,c.value,E.value,e.style]),role:"alert"},{default:()=>[ke(!1,"v-alert"),e.border&&V("div",{key:"border",class:I(["v-alert__border",W.value]),style:B(X.value)},null),b&&V("div",{key:"prepend",class:"v-alert__prepend"},[t.prepend?a(A,{key:"prepend-defaults",disabled:!d.value,defaults:{VIcon:{..._}}},t.prepend):a($,L({key:"prepend-icon"},_),null)]),V("div",{class:"v-alert__content"},[H&&a(Ae,{key:"title"},{default:()=>[t.title?.()??e.title]}),t.text?.()??e.text,t.default?.()]),t.append&&V("div",{key:"append",class:"v-alert__append"},[t.append()]),J&&V("div",{key:"close",class:"v-alert__close"},[t.close?a(A,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>[t.close?.({props:z.value})]}):a(x,L({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},z.value),null)])]})}}}),We={__name:"changePassword",setup(e){const v=y(),m=y(!1),t=y(!1),n=y(""),d=y(""),r=y({currentPassword:"",newPassword:"",confirmPassword:""}),f={required:i=>!!i||"此欄位為必填",minLength:i=>i&&i.length>=8||"密碼長度至少8個字元",passwordMatch:i=>i===r.value.newPassword||"密碼確認不相符"},k=async()=>{if(m.value){t.value=!0,n.value="",d.value="";try{await Ce.put("/api/profile/change-password",{currentPassword:r.value.currentPassword,newPassword:r.value.newPassword}),d.value="密碼已成功變更",p()}catch(i){n.value=i.response?.data?.message||"密碼變更失敗"}finally{t.value=!1}}},p=()=>{r.value={currentPassword:"",newPassword:"",confirmPassword:""},v.value?.reset(),n.value="",d.value=""};return(i,l)=>(C(),S(ge,{fluid:""},{default:s(()=>[a(xe,null,{default:s(()=>[a(ze,{cols:"12",md:"6","offset-md":"3"},{default:s(()=>[a(M,null,{default:s(()=>[a(_e,null,{default:s(()=>[a($,{class:"me-2"},{default:s(()=>[...l[4]||(l[4]=[u("mdi-key-change",-1)])]),_:1}),l[5]||(l[5]=u(" 密碼修改 ",-1))]),_:1}),a(N,null,{default:s(()=>[a(Ie,{ref_key:"form",ref:v,modelValue:o(m),"onUpdate:modelValue":l[3]||(l[3]=c=>be(m)?m.value=c:null)},{default:s(()=>[a(g,{modelValue:o(r).currentPassword,"onUpdate:modelValue":l[0]||(l[0]=c=>o(r).currentPassword=c),label:"目前密碼",type:"password",rules:[f.required],variant:"outlined",class:"mb-4"},null,8,["modelValue","rules"]),a(g,{modelValue:o(r).newPassword,"onUpdate:modelValue":l[1]||(l[1]=c=>o(r).newPassword=c),label:"新密碼",type:"password",rules:[f.required,f.minLength],variant:"outlined",class:"mb-4"},null,8,["modelValue","rules"]),a(g,{modelValue:o(r).confirmPassword,"onUpdate:modelValue":l[2]||(l[2]=c=>o(r).confirmPassword=c),label:"確認新密碼",type:"password",rules:[f.required,f.passwordMatch],variant:"outlined",class:"mb-4"},null,8,["modelValue","rules"]),o(n)?(C(),S(R,{key:0,type:"error",class:"mb-4"},{default:s(()=>[u(F(o(n)),1)]),_:1})):D("",!0),o(d)?(C(),S(R,{key:1,type:"success",class:"mb-4"},{default:s(()=>[u(F(o(d)),1)]),_:1})):D("",!0)]),_:1},8,["modelValue"])]),_:1}),a(Te,null,{default:s(()=>[a(Le),a(x,{onClick:p},{default:s(()=>[...l[6]||(l[6]=[u("清除",-1)])]),_:1}),a(x,{color:"primary",disabled:!o(m)||o(t),loading:o(t),onClick:k},{default:s(()=>[...l[7]||(l[7]=[u(" 變更密碼 ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1}),a(M,{class:"mt-4"},{default:s(()=>[a(Be,null,{default:s(()=>[...l[8]||(l[8]=[u("密碼安全建議",-1)])]),_:1}),a(N,null,{default:s(()=>[a(Se,{density:"compact"},{default:s(()=>[a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[9]||(l[9]=[u("密碼長度至少8個字元",-1)])]),_:1})]),_:1}),a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[10]||(l[10]=[u("包含大小寫字母",-1)])]),_:1})]),_:1}),a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[11]||(l[11]=[u("包含數字",-1)])]),_:1})]),_:1}),a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[12]||(l[12]=[u("包含特殊符號",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{We as default};
