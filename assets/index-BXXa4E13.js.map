{"version":3,"file":"index-BXXa4E13.js","sources":["../../src/components/editField.vue","../../src/views/profile/index.vue"],"sourcesContent":["<template>\r\n  <div class=\"item\">\r\n    <div class=\"label\">{{ label }}</div>\r\n    <div class=\"value\">\r\n      <!-- 文字輸入欄位 -->\r\n      <v-text-field\r\n        v-if=\"isEditing && type === 'text'\"\r\n        :model-value=\"modelValue\"\r\n        @update:model-value=\"$emit('update:modelValue', $event)\"\r\n        variant=\"outlined\"\r\n        density=\"compact\"\r\n        hide-details\r\n        :type=\"inputType\"\r\n      ></v-text-field>\r\n      \r\n      <!-- 多行文字輸入欄位 -->\r\n      <v-textarea\r\n        v-else-if=\"isEditing && type === 'textarea'\"\r\n        :model-value=\"modelValue\"\r\n        @update:model-value=\"$emit('update:modelValue', $event)\"\r\n        variant=\"outlined\"\r\n        density=\"compact\"\r\n        :rows=\"rows || 2\"\r\n        hide-details\r\n      ></v-textarea>\r\n      \r\n      <!-- 下拉選單 -->\r\n      <v-select\r\n        v-else-if=\"isEditing && type === 'select'\"\r\n        :model-value=\"modelValue\"\r\n        @update:model-value=\"$emit('update:modelValue', $event)\"\r\n        :items=\"options\"\r\n        variant=\"outlined\"\r\n        density=\"compact\"\r\n        hide-details\r\n      ></v-select>\r\n      \r\n      <!-- 顯示模式 - chip -->\r\n      <v-chip \r\n        v-else-if=\"!isEditing && chipStyle\"\r\n        color=\"secondary\" \r\n        size=\"small\" \r\n        variant=\"flat\"\r\n        class=\"chip\"\r\n        rounded=\"lg\"\r\n      >\r\n        {{ modelValue }}\r\n      </v-chip>\r\n      \r\n      <!-- 顯示模式 - 一般文字 -->\r\n      <span v-else>{{ modelValue }}</span>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\ndefineProps({\r\n  label: {\r\n    type: String,\r\n    required: true\r\n  },\r\n  modelValue: {\r\n    type: [String, Number],\r\n    default: ''\r\n  },\r\n  isEditing: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  type: {\r\n    type: String,\r\n    default: 'text', // text, textarea, select\r\n    validator: (value) => ['text', 'textarea', 'select'].includes(value)\r\n  },\r\n  inputType: {\r\n    type: String,\r\n    default: 'text' // text, email, date, tel, etc.\r\n  },\r\n  rows: {\r\n    type: Number,\r\n    default: 2\r\n  },\r\n  options: {\r\n    type: Array,\r\n    default: () => []\r\n  },\r\n  chipStyle: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n});\r\n\r\ndefineEmits(['update:modelValue']);\r\n</script>\r\n\r\n<style scoped>\r\n.item {\r\n  padding: 28px 0 12px 0;\r\n  border-bottom: 1px solid #E5E5E5;\r\n  display: flex;\r\n  align-items: flex-start;\r\n}\r\n\r\n.label {\r\n  font-size: 16px;\r\n  font-weight: 400;\r\n  color: #666666;\r\n  width: 80px;\r\n  flex-shrink: 0;\r\n  margin-right: 40px;\r\n  line-height: 1.5;\r\n}\r\n\r\n.value {\r\n  font-size: 16px;\r\n  font-weight: 400;\r\n  color: #333333;\r\n  flex: 1;\r\n  line-height: 1.5;\r\n  word-break: break-all;\r\n}\r\n\r\n.chip {\r\n  font-weight: 500;\r\n  color: white !important;\r\n  padding: 8px 16px;\r\n}\r\n</style>","<template>\r\n  <v-container fluid class=\"pa-2\">\r\n    <v-row justify=\"center\">\r\n      <v-col cols=\"12\" md=\"10\" lg=\"9\">\r\n        <v-row class=\"mb-1\">\r\n          <!-- Left Column -->\r\n          <v-col cols=\"12\" md=\"6\" class=\"pe-md-8\">\r\n            <div>\r\n              <edit-field label=\"姓名\" :model-value=\"isEditing ? editProfile.name : profile.name\" />\r\n\r\n              <edit-field label=\"性別\" :model-value=\"isEditing ? editProfile.gender : profile.gender\"\r\n                :is-editing=\"isEditing\" type=\"select\" :options=\"['男', '女', '其他']\" />\r\n\r\n              <edit-field label=\"出生\" :model-value=\"isEditing ? editProfile.birthDate : profile.birthDate\" />\r\n            </div>\r\n          </v-col>\r\n\r\n          <!-- Right Column -->\r\n          <v-col cols=\"12\" md=\"6\" class=\"ps-md-8\">\r\n            <div class=\"profile-section\">\r\n              <edit-field label=\"信箱\" :model-value=\"isEditing ? editProfile.email : profile.email\"\r\n                :is-editing=\"isEditing\" input-type=\"email\" @update:model-value=\"editProfile.email = $event\" />\r\n\r\n              <edit-field label=\"單位\" :model-value=\"isEditing ? editProfile.unit : profile.unit\" />\r\n\r\n            </div>\r\n          </v-col>\r\n        </v-row>\r\n        <label class=\"view-list\">檢視者</label>\r\n        <div class=\"red\">\r\n          <v-chip v-for=\"viewer in selectedViewers\" :key=\"viewer.userId\" color=\"primary\" closable class=\"ma-1\"\r\n            @click:close=\"removeViewer(viewer.userId)\">\r\n            <v-icon start>mdi-account</v-icon>\r\n            {{ viewer.userName }}\r\n          </v-chip>\r\n\r\n          <div v-if=\"showSearchInput\" class=\"search-input-wrapper\">\r\n            <v-text-field v-model=\"searchQuery\" density=\"compact\" variant=\"outlined\" placeholder=\"請輸入完整姓名\" hide-details\r\n              class=\"search-input\" autofocus @keyup.enter=\"searchAndAddViewer\">\r\n              <template v-slot:append-inner>\r\n                <v-btn icon=\"mdi-magnify\" size=\"small\" variant=\"text\" @click=\"searchAndAddViewer\" />\r\n              </template>\r\n            </v-text-field>\r\n          </div>\r\n\r\n          <v-btn v-else icon size=\"small\" color=\"cyan\" variant=\"flat\" class=\"add-btn\" @click=\"showSearchInput = true\">\r\n            <v-icon>mdi-plus</v-icon>\r\n          </v-btn>\r\n        </div>\r\n        <label class=\"view-list\" v-if=\"我可以看到誰.length > 0\">可檢視名單</label>\r\n        <div class=\"box\" style=\"background: aliceblue;\" v-if=\"我可以看到誰.length > 0\">\r\n          <v-chip color=\"primary\" class=\"ma-1\" v-for=\"item in 我可以看到誰\">\r\n            {{ item }}\r\n          </v-chip>\r\n        </div>\r\n        <!-- \r\n        4. 【個人資料】\r\n「檢視者」：選教練(不能模糊搜尋)，誰可以看到我的資料(使用者自行設定「教練」)\r\n檢視者清單增加單位，如：排球隊－王曉明\r\n5.個人權限設定只有管理員可以用\r\n   文字修改：人員資訊→可檢視名單 -->\r\n\r\n      </v-col>\r\n    </v-row>\r\n\r\n    <v-snackbar v-model=\"snackbar\" :timeout=\"3000\" color=\"error\">\r\n      {{ snackbarMessage }}\r\n    </v-snackbar>\r\n  </v-container>\r\n</template>\r\n\r\n<script setup>\r\nimport editField from '@/components/editField.vue'\r\n\r\nconst profile = ref({\r\n  name: \"王安迪\",\r\n  email: \"wangdadada@gmail.com\",\r\n  birthDate: \"1990-01-01\",\r\n  unit: \"國家運動中心\",\r\n  gender: \"男\",\r\n});\r\n\r\nconst isEditing = ref(false);\r\nconst editProfile = ref({});\r\nconst 我可以看到誰 = ref([\r\n  \"王曉明\",\r\n  \"李小華\",\r\n  \"張大明\",\r\n]);\r\n\r\nconst selectedViewers = ref([]);\r\nconst showSearchInput = ref(false);\r\nconst searchQuery = ref('');\r\nconst snackbar = ref(false);\r\nconst snackbarMessage = ref('');\r\n\r\nonMounted(async () => {\r\n  const response = await axios.get('/api/useruser/my/userDown')\r\n  我可以看到誰.value = response.data.map(a => a.userName)\r\n\r\n  // 載入檢視者清單\r\n  await loadViewers();\r\n});\r\n\r\nconst loadViewers = async () => {\r\n  try {\r\n    const response = await axios.get(`/api/useruser/my/userUp`);\r\n    selectedViewers.value = response.data;\r\n  } catch (error) {\r\n    console.error('載入檢視者清單失敗', error);\r\n  }\r\n};\r\n\r\nconst searchAndAddViewer = async () => {\r\n  // 檢查輸入長度\r\n  if (searchQuery.value.trim().length < 2) {\r\n    snackbarMessage.value = '請輸入至少2個字元';\r\n    snackbar.value = true;\r\n    return;\r\n  }\r\n\r\n  try {\r\n    // 驗證使用者是否存在\r\n    const checkResponse = await axios.get(`/api/users/check/${searchQuery.value.trim()}`);\r\n    const { userId, userName } = checkResponse.data;\r\n\r\n    // 檢查是否已存在\r\n    if (selectedViewers.value.some(v => v.userId === userId)) {\r\n      snackbarMessage.value = '該檢視者已在名單中';\r\n      snackbar.value = true;\r\n      return;\r\n    }\r\n\r\n    // 新增檢視者\r\n    await axios.post(`/api/useruser/my/userUp`, JSON.stringify(userId), {\r\n      headers: { 'Content-Type': 'application/json' }\r\n    });\r\n\r\n    // 更新 UI\r\n    selectedViewers.value.push({ userId, userName });\r\n    searchQuery.value = '';\r\n    showSearchInput.value = false;\r\n\r\n  } catch (error) {\r\n    if (error.response?.status === 404) {\r\n      snackbarMessage.value = '找不到該使用者';\r\n    } else {\r\n      snackbarMessage.value = '新增失敗，請稍後再試';\r\n    }\r\n    snackbar.value = true;\r\n  }\r\n};\r\n\r\nconst removeViewer = async (userId) => {\r\n  try {\r\n    await axios.delete(`/api/useruser/my/${userId}`);\r\n    selectedViewers.value = selectedViewers.value.filter(v => v.userId !== userId);\r\n  } catch (error) {\r\n    snackbarMessage.value = '刪除失敗，請稍後再試';\r\n    snackbar.value = true;\r\n  }\r\n};\r\n\r\nconst startEdit = () => {\r\n  editProfile.value = { ...profile.value };\r\n  isEditing.value = true;\r\n};\r\n\r\nconst saveChanges = () => {\r\n  profile.value = { ...editProfile.value };\r\n  isEditing.value = false;\r\n  console.log(\"個人資料已儲存\");\r\n};\r\n\r\nconst cancelEdit = () => {\r\n  editProfile.value = {};\r\n  isEditing.value = false;\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.edit-btn {\r\n  padding: 12px 24px !important;\r\n  font-size: 16px;\r\n  font-weight: 500;\r\n  box-shadow: 0 2px 8px rgba(79, 195, 247, 0.3);\r\n}\r\n\r\n.view-list {\r\n  font-size: 16px;\r\n  font-weight: 400;\r\n  color: #666666;\r\n  width: 80px;\r\n  flex-shrink: 0;\r\n  margin-right: 40px;\r\n  line-height: 1.5;\r\n}\r\n\r\n.red {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  align-items: center;\r\n  gap: 8px;\r\n  margin-top: 8px;\r\n  margin-bottom: 24px;\r\n}\r\n\r\n.blue {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 8px;\r\n  margin-top: 8px;\r\n}\r\n\r\n.add-btn {\r\n  width: 32px;\r\n  height: 32px;\r\n}\r\n\r\n.search-input-wrapper {\r\n  flex: 0 0 300px;\r\n}\r\n\r\n.search-input {\r\n  max-width: 300px;\r\n}\r\n</style>"],"names":["_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_toDisplayString","__props","_hoisted_3","_createBlock","_component_v_text_field","_cache","$event","$emit","_component_v_textarea","_component_v_select","_component_v_chip","profile","ref","isEditing","editProfile","我可以看到誰","selectedViewers","showSearchInput","searchQuery","snackbar","snackbarMessage","onMounted","response","axios","loadViewers","error","searchAndAddViewer","checkResponse","userId","userName","v","removeViewer","_component_v_container","_createVNode","_component_v_row","_component_v_col","editField","_unref","_Fragment","_renderList","viewer","_component_v_icon","_component_v_btn","_hoisted_4","_hoisted_5","item","_component_v_snackbar"],"mappings":"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"}