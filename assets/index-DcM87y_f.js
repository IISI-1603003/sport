import{b as v,o as s,d as b,z as k,j as c,t as z,D as K,w as n,m as g,I as C,f as m,h as M,a as h,e as l,n as U,u as e,F as B,y as E,V as D,aj as J,q as T,p as F}from"./index-D5t5jYde.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as L}from"./VTextarea-BbPFWmDj.js";import{V as O}from"./VContainer-DF_1CXP2.js";import{V as j,a as S}from"./VRow-kfv7cwZP.js";import{V as P}from"./VSnackbar-Rdmky861.js";/* empty css              */import"./layout-CIUhZj6z.js";const Q={class:"item"},G={class:"label"},H={class:"value"},W={key:4},X={__name:"editField",props:{label:{type:String,required:!0},modelValue:{type:[String,Number],default:""},isEditing:{type:Boolean,default:!1},type:{type:String,default:"text",validator:t=>["text","textarea","select"].includes(t)},inputType:{type:String,default:"text"},rows:{type:Number,default:2},options:{type:Array,default:()=>[]},chipStyle:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(t){return(r,i)=>(s(),v("div",Q,[b("div",G,k(t.label),1),b("div",H,[t.isEditing&&t.type==="text"?(s(),c(z,{key:0,"model-value":t.modelValue,"onUpdate:modelValue":i[0]||(i[0]=d=>r.$emit("update:modelValue",d)),variant:"outlined",density:"compact","hide-details":"",type:t.inputType},null,8,["model-value","type"])):t.isEditing&&t.type==="textarea"?(s(),c(L,{key:1,"model-value":t.modelValue,"onUpdate:modelValue":i[1]||(i[1]=d=>r.$emit("update:modelValue",d)),variant:"outlined",density:"compact",rows:t.rows||2,"hide-details":""},null,8,["model-value","rows"])):t.isEditing&&t.type==="select"?(s(),c(K,{key:2,"model-value":t.modelValue,"onUpdate:modelValue":i[2]||(i[2]=d=>r.$emit("update:modelValue",d)),items:t.options,variant:"outlined",density:"compact","hide-details":""},null,8,["model-value","items"])):!t.isEditing&&t.chipStyle?(s(),c(C,{key:3,color:"secondary",size:"small",variant:"flat",class:"chip",rounded:"lg"},{default:n(()=>[g(k(t.modelValue),1)]),_:1})):(s(),v("span",W,k(t.modelValue),1))])]))}},w=A(X,[["__scopeId","data-v-9848bcf4"]]),Y={class:"profile-section"},Z={class:"red"},_={key:0,class:"search-input-wrapper"},ee={key:0,class:"view-list"},ae={key:1,class:"box",style:{background:"aliceblue"}},te={__name:"index",setup(t){const r=m({name:"王安迪",email:"wangdadada@gmail.com",birthDate:"1990-01-01",unit:"國家運動中心",gender:"男"}),i=m(!1),d=m({}),x=m(["王曉明","李小華","張大明"]),y=m([]),$=m(!1),f=m(""),p=m(!1),V=m("");M(async()=>{const u=await h.get("/api/useruser/my/userDown");x.value=u.data.map(a=>a.userName),await R()});const R=async()=>{try{const u=await h.get("/api/useruser/my/userUp");y.value=u.data}catch(u){console.error("載入檢視者清單失敗",u)}},N=async()=>{if(f.value.trim().length<2){V.value="請輸入至少2個字元",p.value=!0;return}try{const u=await h.get(`/api/users/check/${f.value.trim()}`),{userId:a,userName:o}=u.data;if(y.value.some(I=>I.userId===a)){V.value="該檢視者已在名單中",p.value=!0;return}await h.post("/api/useruser/my/userUp",JSON.stringify(a),{headers:{"Content-Type":"application/json"}}),y.value.push({userId:a,userName:o}),f.value="",$.value=!1}catch(u){u.response?.status===404?V.value="找不到該使用者":V.value="新增失敗，請稍後再試",p.value=!0}},q=async u=>{try{await h.delete(`/api/useruser/my/${u}`),y.value=y.value.filter(a=>a.userId!==u)}catch{V.value="刪除失敗，請稍後再試",p.value=!0}};return(u,a)=>(s(),c(O,{fluid:"",class:"pa-2"},{default:n(()=>[l(j,{justify:"center"},{default:n(()=>[l(S,{cols:"12",md:"10",lg:"9"},{default:n(()=>[l(j,{class:"mb-1"},{default:n(()=>[l(S,{cols:"12",md:"6",class:"pe-md-8"},{default:n(()=>[b("div",null,[l(w,{label:"姓名","model-value":e(i)?e(d).name:e(r).name},null,8,["model-value"]),l(w,{label:"性別","model-value":e(i)?e(d).gender:e(r).gender,"is-editing":e(i),type:"select",options:["男","女","其他"]},null,8,["model-value","is-editing"]),l(w,{label:"出生","model-value":e(i)?e(d).birthDate:e(r).birthDate},null,8,["model-value"])])]),_:1}),l(S,{cols:"12",md:"6",class:"ps-md-8"},{default:n(()=>[b("div",Y,[l(w,{label:"信箱","model-value":e(i)?e(d).email:e(r).email,"is-editing":e(i),"input-type":"email","onUpdate:modelValue":a[0]||(a[0]=o=>e(d).email=o)},null,8,["model-value","is-editing"]),l(w,{label:"單位","model-value":e(i)?e(d).unit:e(r).unit},null,8,["model-value"])])]),_:1})]),_:1}),a[6]||(a[6]=b("label",{class:"view-list"},"檢視者",-1)),b("div",Z,[(s(!0),v(B,null,E(e(y),o=>(s(),c(C,{key:o.userId,color:"primary",closable:"",class:"ma-1","onClick:close":I=>q(o.userId)},{default:n(()=>[l(D,{start:""},{default:n(()=>[...a[4]||(a[4]=[g("mdi-account",-1)])]),_:1}),g(" "+k(o.userName),1)]),_:2},1032,["onClick:close"]))),128)),e($)?(s(),v("div",_,[l(z,{modelValue:e(f),"onUpdate:modelValue":a[1]||(a[1]=o=>T(f)?f.value=o:null),density:"compact",variant:"outlined",placeholder:"請輸入完整姓名","hide-details":"",class:"search-input",autofocus:"",onKeyup:J(N,["enter"])},{"append-inner":n(()=>[l(F,{icon:"mdi-magnify",size:"small",variant:"text",onClick:N})]),_:1},8,["modelValue"])])):(s(),c(F,{key:1,icon:"",size:"small",color:"cyan",variant:"flat",class:"add-btn",onClick:a[2]||(a[2]=o=>$.value=!0)},{default:n(()=>[l(D,null,{default:n(()=>[...a[5]||(a[5]=[g("mdi-plus",-1)])]),_:1})]),_:1}))]),e(x).length>0?(s(),v("label",ee,"可檢視名單")):U("",!0),e(x).length>0?(s(),v("div",ae,[(s(!0),v(B,null,E(e(x),o=>(s(),c(C,{color:"primary",class:"ma-1"},{default:n(()=>[g(k(o),1)]),_:2},1024))),256))])):U("",!0)]),_:1})]),_:1}),l(P,{modelValue:e(p),"onUpdate:modelValue":a[3]||(a[3]=o=>T(p)?p.value=o:null),timeout:3e3,color:"error"},{default:n(()=>[g(k(e(V)),1)]),_:1},8,["modelValue"])]),_:1}))}},me=A(te,[["__scopeId","data-v-55f79516"]]);export{me as default};
