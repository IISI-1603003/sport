{"version":3,"file":"index-BVEnHxr2.js","sources":["../../src/views/signIn/index.vue"],"sourcesContent":["<template>\r\n  <v-form @submit.prevent=\"submit\">\r\n    <h2 class=\"text-center\">登入</h2>\r\n    <div class=\"d-flex align-center ga-3\">\r\n      <v-icon>mdi-account</v-icon>\r\n      <input type=\"text\" class=\"input\" required v-model=\"form.username\" />\r\n    </div>\r\n    <div class=\"d-flex align-center ga-3\">\r\n      <v-icon>mdi-lock</v-icon>\r\n      <input type=\"password\" class=\"input\" required v-model=\"form.p\" />\r\n    </div>\r\n    <router-link to=\"/sign-in/forget\" class=\"float-right text-decoration-none\">\r\n      忘記密碼\r\n    </router-link>\r\n    <br />\r\n    <div class=\"d-flex align-center ga-3\">\r\n      <input id=\"captcha\" ref=\"captchaRef\" type=\"text\" v-model=\"captcha.code\"\r\n        @input=\"captcha.code = captcha.code.toUpperCase()\" placeholder=\"輸入驗證碼\" class=\"input input-bordered flex-grow-1\"\r\n        required />\r\n      <img v-if=\"imageSrc\" :src=\"imageSrc\" alt=\"captcha\" class=\"ga-3\" style=\"max-width: 150px;\" />\r\n      <v-icon @click.prevent=\"loadImage()\">mdi-refresh</v-icon>\r\n    </div>\r\n    <v-btn type=\"submit\" variant=\"flat\" color=\"primary\" block class=\"mt-5\" :loading=\"loading\">\r\n      登入\r\n    </v-btn>\r\n    <div class=\"or\">或</div>\r\n    <div class=\"or-container\">\r\n      <v-btn color=\"secondary\" class=\"or-item my-1\">\r\n        <router-link to=\"/sign-in/register\" class=\"text-decoration-none\">\r\n          一般帳號註冊\r\n        </router-link>\r\n      </v-btn>\r\n      <div class=\"ml-3\"></div>\r\n      <v-btn color=\"success\" class=\"or-item my-1\">\r\n        <router-link to=\"/sign-in/registerAD\" class=\"text-decoration-none\">\r\n          AD帳號註冊\r\n        </router-link>\r\n      </v-btn>\r\n    </div>\r\n  </v-form>\r\n</template>\r\n\r\n<script setup>\r\nimport { auth } from \"@/helpers/auth\";\r\nimport { alertError } from \"@/helpers/functions\";\r\nimport { useReCaptcha } from \"vue-recaptcha-v3\";\r\nimport { authentication } from \"@/requests\";\r\nimport { onMounted } from \"vue\";\r\n\r\nconst { signIn } = auth();\r\nconst { executeRecaptcha } = useReCaptcha();\r\nconst loading = ref(false);\r\nconst form = ref({\r\n  username: \"iisi-admin\",\r\n  p: \"Tiss2025@dmin!@#\",\r\n});\r\nconst imageSrc = ref();\r\nconst captcha = ref({\r\n  guid: null,\r\n  code: 1\r\n});\r\n\r\nonMounted(async () => {\r\n  loadImage();\r\n});\r\nconst loadImage = async () => {\r\n  let { data } = await authentication.captcha();\r\n  let base64 = btoa(new Uint8Array(data).reduce((data, byte) => data + String.fromCharCode(byte), ''));\r\n  imageSrc.value = `data:image/png;base64,${base64}`;\r\n}\r\n\r\nconst submit = async () => {\r\n  if (loading.value) return;\r\n  loading.value = true;\r\n  const token = await executeRecaptcha(\"signIn\");\r\n  authentication\r\n    .signIn(form.value, { headers: { token, code: captcha.value.code } })\r\n    .then((a) => {\r\n      signIn(a.data);\r\n    })\r\n    .catch((a) => {\r\n      alert(a.response.data || \"系統異常，請稍後再試。\");\r\n      loadImage();\r\n    })\r\n    .finally(() => {\r\n      loading.value = false;\r\n    })\r\n};\r\n</script>\r\n<style scoped>\r\n.or-container {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n.or-item {\r\n  flex: 1;\r\n}\r\n</style>"],"names":["signIn","auth","executeRecaptcha","useReCaptcha","loading","ref","form","imageSrc","captcha","onMounted","loadImage","data","authentication","base64","byte","submit","token","a","_createBlock","_component_v_form","_cache","_createElementVNode","_hoisted_1","_createVNode","_component_v_icon","$event","_unref","_vModelText","_hoisted_2","_component_router_link","_hoisted_3","_createElementBlock","_component_v_btn","_hoisted_5"],"mappings":"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"}