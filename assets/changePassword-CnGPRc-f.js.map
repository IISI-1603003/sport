{"version":3,"file":"changePassword-CnGPRc-f.js","sources":["../../src/views/profile/changePassword.vue"],"sourcesContent":["<template>\r\n  <v-container fluid>\r\n    <v-row>\r\n      <v-col cols=\"12\" md=\"6\" offset-md=\"3\">\r\n        <v-card>\r\n          <v-card-title>\r\n            <v-icon class=\"me-2\">mdi-key-change</v-icon>\r\n            密碼修改\r\n          </v-card-title>\r\n          <v-card-text>\r\n            <v-form ref=\"form\" v-model=\"valid\">\r\n              <v-text-field\r\n                v-model=\"passwordForm.currentPassword\"\r\n                label=\"目前密碼\"\r\n                type=\"password\"\r\n                :rules=\"[rules.required]\"\r\n                variant=\"outlined\"\r\n                class=\"mb-4\"\r\n              ></v-text-field>\r\n              \r\n              <v-text-field\r\n                v-model=\"passwordForm.newPassword\"\r\n                label=\"新密碼\"\r\n                type=\"password\"\r\n                :rules=\"[rules.required, rules.minLength]\"\r\n                variant=\"outlined\"\r\n                class=\"mb-4\"\r\n              ></v-text-field>\r\n              \r\n              <v-text-field\r\n                v-model=\"passwordForm.confirmPassword\"\r\n                label=\"確認新密碼\"\r\n                type=\"password\"\r\n                :rules=\"[rules.required, rules.passwordMatch]\"\r\n                variant=\"outlined\"\r\n                class=\"mb-4\"\r\n              ></v-text-field>\r\n              \r\n              <v-alert\r\n                v-if=\"error\"\r\n                type=\"error\"\r\n                class=\"mb-4\"\r\n              >\r\n                {{ error }}\r\n              </v-alert>\r\n              \r\n              <v-alert\r\n                v-if=\"success\"\r\n                type=\"success\"\r\n                class=\"mb-4\"\r\n              >\r\n                {{ success }}\r\n              </v-alert>\r\n            </v-form>\r\n          </v-card-text>\r\n          <v-card-actions>\r\n            <v-spacer></v-spacer>\r\n            <v-btn @click=\"resetForm\">清除</v-btn>\r\n            <v-btn \r\n              color=\"primary\" \r\n              :disabled=\"!valid || loading\"\r\n              :loading=\"loading\"\r\n              @click=\"changePassword\"\r\n            >\r\n              變更密碼\r\n            </v-btn>\r\n          </v-card-actions>\r\n        </v-card>\r\n        \r\n        <v-card class=\"mt-4\">\r\n          <v-card-subtitle>密碼安全建議</v-card-subtitle>\r\n          <v-card-text>\r\n            <v-list density=\"compact\">\r\n              <v-list-item prepend-icon=\"mdi-check-circle\" color=\"success\">\r\n                <v-list-item-title>密碼長度至少8個字元</v-list-item-title>\r\n              </v-list-item>\r\n              <v-list-item prepend-icon=\"mdi-check-circle\" color=\"success\">\r\n                <v-list-item-title>包含大小寫字母</v-list-item-title>\r\n              </v-list-item>\r\n              <v-list-item prepend-icon=\"mdi-check-circle\" color=\"success\">\r\n                <v-list-item-title>包含數字</v-list-item-title>\r\n              </v-list-item>\r\n              <v-list-item prepend-icon=\"mdi-check-circle\" color=\"success\">\r\n                <v-list-item-title>包含特殊符號</v-list-item-title>\r\n              </v-list-item>\r\n            </v-list>\r\n          </v-card-text>\r\n        </v-card>\r\n      </v-col>\r\n    </v-row>\r\n  </v-container>\r\n</template>\r\n\r\n<script setup>\r\nconst form = ref()\r\nconst valid = ref(false)\r\nconst loading = ref(false)\r\nconst error = ref('')\r\nconst success = ref('')\r\n\r\nconst passwordForm = ref({\r\n  currentPassword: '',\r\n  newPassword: '',\r\n  confirmPassword: ''\r\n})\r\n\r\nconst rules = {\r\n  required: value => !!value || '此欄位為必填',\r\n  minLength: value => (value && value.length >= 8) || '密碼長度至少8個字元',\r\n  passwordMatch: value => value === passwordForm.value.newPassword || '密碼確認不相符'\r\n}\r\n\r\nconst changePassword = async () => {\r\n  if (!valid.value) return\r\n  \r\n  loading.value = true\r\n  error.value = ''\r\n  success.value = ''\r\n  \r\n  try {\r\n    await axios.put('/api/profile/change-password', {\r\n      currentPassword: passwordForm.value.currentPassword,\r\n      newPassword: passwordForm.value.newPassword\r\n    })\r\n    \r\n    success.value = '密碼已成功變更'\r\n    resetForm()\r\n  } catch (err) {\r\n    error.value = err.response?.data?.message || '密碼變更失敗'\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst resetForm = () => {\r\n  passwordForm.value = {\r\n    currentPassword: '',\r\n    newPassword: '',\r\n    confirmPassword: ''\r\n  }\r\n  form.value?.reset()\r\n  error.value = ''\r\n  success.value = ''\r\n}\r\n</script>\r\n"],"names":["form","ref","valid","loading","error","success","passwordForm","rules","value","changePassword","axios","resetForm","err","_createBlock","_component_v_container","_createVNode","_component_v_row","_component_v_col","_component_v_card","_component_v_card_title","_component_v_icon","_cache","_component_v_card_text","_component_v_form","_unref","$event","_component_v_text_field","_component_v_alert","_component_v_card_actions","_component_v_spacer","_component_v_btn","_component_v_card_subtitle","_component_v_list","_component_v_list_item","_component_v_list_item_title"],"mappings":"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"}