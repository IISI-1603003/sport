import{e as f,j as $,o as _,w as l,d as e,b as y,p,V as U,m as v,t as g,u,E as j,q as A,B as k,f as q,N as O,Q as L,P,H as W,a as z,F as H,I as M}from"./index-C1z4PiDl.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as C,a as F,b as I,c as R,d as Q}from"./VCard-CYS_1bHD.js";import{V as E}from"./VTextarea-BP4hdr6I.js";import{V as T}from"./VSpacer-xikvbgC2.js";import{V as B}from"./VDialog-U9CmAI7S.js";import{_ as S}from"./functions-mudWwGpo.js";import{_ as G}from"./delete-alert-icon-DPvorr65.js";import{V as J,a as w}from"./VRow-C8T6qQjI.js";/* empty css              */const K={__name:"create",emits:["add-to-list"],setup(N,{emit:V}){const t=f({id:"",serialNumber:"",name:"",description:""}),s=V,r=f(!1);function d(){t.value.id=crypto.randomUUID(),k.save(t.value).then(()=>{s("add-to-list",{...t.value}),t.value.id="",t.value.serialNumber="",t.value.name="",t.value.description="",r.value=!1})}function m(){t.value.id="",t.value.serialNumber="",t.value.name="",t.value.description="",r.value=!1}return(x,n)=>(_(),$(B,{modelValue:u(r),"onUpdate:modelValue":n[6]||(n[6]=i=>A(r)?r.value=i:null),"max-width":"500"},{activator:l(({props:i})=>[e(p,j(i,{title:"新增",color:"success"}),{default:l(()=>[...n[7]||(n[7]=[v("+新增",-1)])]),_:1},16)]),default:l(({isActive:i})=>[e(C,{class:"review-border"},{default:l(()=>[e(F,{class:"d-flex justify-space-between align-center"},{default:l(()=>[n[9]||(n[9]=y("span",{class:"text-blue"},"新增角色",-1)),e(p,{icon:"",variant:"text",onClick:n[0]||(n[0]=o=>m())},{default:l(()=>[e(U,null,{default:l(()=>[...n[8]||(n[8]=[v("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),e(I,null,{default:l(()=>[e(g,{"hide-details":"auto",modelValue:u(t).serialNumber,"onUpdate:modelValue":n[1]||(n[1]=o=>u(t).serialNumber=o),density:"compact",label:"角色編號","prepend-inner-icon":"mdi-music-accidental-sharp",variant:"solo",required:"",class:"mb-5"},{label:l(()=>[...n[10]||(n[10]=[v(" 角色編號 ",-1)])]),_:1},8,["modelValue"]),e(g,{"hide-details":"auto",modelValue:u(t).name,"onUpdate:modelValue":n[2]||(n[2]=o=>u(t).name=o),density:"compact",label:"角色名稱","prepend-inner-icon":"mdi-account",variant:"solo",required:"",class:"mb-5"},{label:l(()=>[...n[11]||(n[11]=[v(" 角色名稱 ",-1)])]),_:1},8,["modelValue"]),e(E,{modelValue:u(t).description,"onUpdate:modelValue":n[3]||(n[3]=o=>u(t).description=o),label:"描述",density:"compact",variant:"solo",required:"",placeholder:"描述"},null,8,["modelValue"])]),_:1}),e(R,null,{default:l(()=>[e(T),e(p,{text:"取消",variant:"outlined",color:"grey-darken-2",onClick:n[4]||(n[4]=o=>m())}),e(p,{text:"確認",variant:"outlined",color:"primary",onClick:n[5]||(n[5]=o=>d())})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},X=D(K,[["__scopeId","data-v-0e73bc64"]]),Y={__name:"edit",props:{role:{type:Object,required:!0,default:()=>({id:"",serialNumber:"",name:"",description:""})}},emits:["edit-role"],setup(N,{emit:V}){const t=N,s=f({id:"",serialNumber:"",name:"",description:""}),r=f({menus:[],pages:[],operations:[],apis:[]}),d=f(null);q(async()=>{s.value.id=t.role.id,s.value.serialNumber=t.role.serialNumber,s.value.name=t.role.name,s.value.description=t.role.description});const m=f(!1);function x(){k.update({id:s.value.id},s.value).then(()=>{k.updateFunctions({id:s.value.id},r.value).then(()=>{})}),m.value=!1}function n(){s.value.id=t.role.id,s.value.serialNumber=t.role.serialNumber,s.value.name=t.role.name,s.value.description=t.role.description,m.value=!1}const i=o=>{Object.assign(r.value,o)};return O(()=>m.value,async o=>{if(o){const[a,c]=await Promise.all([k.get({id:s.value.id}),k.functions({id:s.value.id})]);Object.assign(s.value,a.data),Object.assign(r.value,c.data),await L(),d.value&&(d.value.deselectAll(),d.value.selection([...c.data.menus,...c.data.pages,...c.data.operations,...c.data.apis]))}},{immediate:!0}),(o,a)=>(_(),$(B,{modelValue:u(m),"onUpdate:modelValue":a[6]||(a[6]=c=>A(m)?m.value=c:null),"max-width":"500"},{activator:l(({props:c})=>[e(p,j(c,{title:"編輯",icon:"mdi-pencil",size:"small",variant:"text"}),null,16)]),default:l(({isActive:c})=>[e(C,{class:"review-border"},{default:l(()=>[e(F,{class:"d-flex justify-space-between align-center"},{default:l(()=>[a[8]||(a[8]=y("span",{class:"text-blue"},"編輯角色",-1)),e(p,{icon:"",variant:"text",onClick:a[0]||(a[0]=b=>n())},{default:l(()=>[e(U,null,{default:l(()=>[...a[7]||(a[7]=[v("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),e(I,null,{default:l(()=>[e(g,{"hide-details":"auto",modelValue:u(s).serialNumber,"onUpdate:modelValue":a[1]||(a[1]=b=>u(s).serialNumber=b),density:"compact",label:"角色編號","prepend-inner-icon":"mdi-music-accidental-sharp",variant:"solo",required:"",class:"mb-5"},{label:l(()=>[...a[9]||(a[9]=[v(" 角色編號 ",-1)])]),_:1},8,["modelValue"]),e(g,{"hide-details":"auto",modelValue:u(s).name,"onUpdate:modelValue":a[2]||(a[2]=b=>u(s).name=b),density:"compact",label:"角色名稱","prepend-inner-icon":"mdi-account",variant:"solo",required:"",class:"mb-5"},{label:l(()=>[...a[10]||(a[10]=[v(" 角色名稱 ",-1)])]),_:1},8,["modelValue"]),e(E,{modelValue:u(s).description,"onUpdate:modelValue":a[3]||(a[3]=b=>u(s).description=b),label:"描述",density:"compact",variant:"solo",required:"",placeholder:"描述"},null,8,["modelValue"]),e(C,null,{default:l(()=>[e(Q,null,{default:l(()=>[e(P,null,{default:l(()=>[...a[11]||(a[11]=[v("功能",-1)])]),_:1}),e(S,{ref_key:"tcFunctions",ref:d,onChange:i,class:"mt-2"},null,512)]),_:1})]),_:1})]),_:1}),e(R,null,{default:l(()=>[e(T),e(p,{text:"取消",variant:"outlined",color:"grey-darken-2",onClick:a[4]||(a[4]=b=>n())}),e(p,{text:"確認",variant:"outlined",color:"primary",onClick:a[5]||(a[5]=b=>x())})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},Z=D(Y,[["__scopeId","data-v-eaaf53ab"]]),h={__name:"delete",props:{role:{type:Object,required:!0,default:()=>({id:"",number:"",text:"",info:""})}},emits:["delete-role"],setup(N,{emit:V}){const t=N,s=V,r=f({id:"",number:"",text:"",info:""});q(()=>{r.value.id=t.role.id});const d=f(!1);function m(){k.delete({id:r.value.id}).then(()=>{s("delete-role",r.value.id),r.value.id="",d.value=!1}).catch(n=>{alert("刪除失敗，請重新整理後再試一次"),d.value=!1})}function x(){d.value=!1}return(n,i)=>(_(),$(B,{modelValue:u(d),"onUpdate:modelValue":i[3]||(i[3]=o=>A(d)?d.value=o:null),"max-width":"500"},{activator:l(({props:o})=>[e(p,j(o,{title:"刪除",icon:"mdi-trash-can",size:"small",variant:"text"}),null,16)]),default:l(({isActive:o})=>[e(C,null,{default:l(()=>[e(F,{class:"d-flex justify-space-between align-center"},{default:l(()=>[i[5]||(i[5]=y("span",{class:"text-blue"},null,-1)),e(p,{icon:"",variant:"text",onClick:i[0]||(i[0]=a=>x())},{default:l(()=>[e(U,null,{default:l(()=>[...i[4]||(i[4]=[v("mdi-close",-1)])]),_:1})]),_:1})]),_:1}),e(I,null,{default:l(()=>[...i[6]||(i[6]=[y("div",{class:"delete-info"},[y("img",{src:G,alt:"Delete Alert Icon",class:"delete-alert"}),y("span",null,[v("是否確認"),y("span",{class:"text-red"},"刪除"),v("?")])],-1)])]),_:1}),e(R,{class:"d-flex justify-center mb-5"},{default:l(()=>[e(p,{text:"取消",variant:"outlined",color:"grey-darken-2",onClick:i[1]||(i[1]=a=>x())}),e(T,{style:{flex:"0.25"}}),e(p,{text:"確認",variant:"outlined",color:"primary",onClick:i[2]||(i[2]=a=>m())})]),_:1})]),_:1})]),_:1},8,["modelValue"]))}},ee=D(h,[["__scopeId","data-v-9fec529c"]]),me={__name:"list",setup(N){const V=f([]);q(()=>{n()});const t=f(""),s=W(()=>V.value.filter(i=>!t.value||i.serialNumber&&i.serialNumber.includes(t.value)||i.name&&i.name.includes(t.value)||i.description&&i.description.includes(t.value))),r=f([{title:"角色編號",key:"serialNumber"},{title:"角色名稱",key:"name"},{title:"描述",key:"description"},{title:"編輯",key:"edit",sortable:!1},{title:"刪除",key:"delete",sortable:!1}]);function d(){n()}function m(){n()}function x(){n()}function n(){k.list().then(i=>{V.value=i.data})}return(i,o)=>(_(),z(H,null,[e(J,{class:"mt-1"},{default:l(()=>[e(w,{cols:"4"},{default:l(()=>[e(g,{label:"搜尋",modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=a=>t.value=a),density:"compact",variant:"outlined"},null,8,["modelValue"])]),_:1}),e(w,{cols:"4"}),e(w,{cols:"4",class:"d-flex justify-end"},{default:l(()=>[e(X,{onAddToList:d})]),_:1})]),_:1}),e(C,{class:"rounded-lg elevation-3"},{default:l(()=>[e(M,{headers:r.value,items:s.value,density:"comfortable",class:"cyan-header"},{"item.edit":l(({item:a})=>[e(Z,{role:a,onEditRole:m},null,8,["role"])]),"item.delete":l(({item:a})=>[e(ee,{role:a,onDeleteRole:x},null,8,["role"])]),_:1},8,["headers","items"])]),_:1})],64))}};export{me as default};
