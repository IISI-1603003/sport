import{R as B,f as l,h as F,s as I,x as w,j as c,w as s,q as E,u as o,k as z,r as T,o as u,d as n,b as C,e as v,F as h,y as D,m as d,z as f,t as L,p as g}from"./index-qQnhZZMI.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as U}from"./VForm-C86CbLEY.js";const j={class:"label-item"},P={class:"label-item"},$={style:{"white-space":"nowrap"}},A={__name:"registerStep1",setup(G){const y=I(),{executeRecaptcha:H}=B.useReCaptcha(),V=l(!1),p=l(!0);l(""),l(!1),l(!1);const t=l({userName:"",name:"",email:"",code:""}),m=l({userName:"",name:"",email:""}),R={userName:"帳號/員工編號",name:"姓名",email:"信箱"};F(()=>{const a=y.currentRoute.value.query;m.value.userName=a.userName||"",m.value.name=a.name||"",m.value.email=a.email||"",t.value.userName=a.userName||"",t.value.name=a.name||"",t.value.email=a.email||"",x(),N(a.email)});const S=a=>R[a]||a,r=l(0);let b=null;function x(){r.value>0||(r.value=60,b=setInterval(()=>{r.value>0?r.value--:clearInterval(b)},1e3))}function N(a){w.getEmailVarifyCode(a).then(()=>{x()})}const q=async()=>{w.getDataFromTISS(t.value.email,t.value.code).then(a=>{a.data,console.log(a),a.status===200?(V.value=!0,y.push({path:"/sign-in/registerStep2",query:{email:t.value.email,name:t.value.name,userName:t.value.userName,gender:"男",unit:"運動中心"}})):alert("驗證碼錯誤，請重新輸入。")}).catch(()=>{alert("驗證碼錯誤，請重新輸入。")})};return(a,e)=>{const _=T("router-link");return u(),c(U,{onSubmit:z(q,["prevent"]),modelValue:o(p),"onUpdate:modelValue":e[2]||(e[2]=i=>E(p)?p.value=i:null),class:"mx-auto register-form"},{default:s(()=>[e[8]||(e[8]=n("h2",{class:"text-center mb-3"},"一般帳號註冊",-1)),(u(!0),C(h,null,D(o(m),(i,k)=>(u(),C("div",{key:k,class:"label-container text-start mt-3"},[n("span",j,f(S(k)),1),e[3]||(e[3]=d()),n("span",P,f(i),1)]))),128)),v(L,{"hide-details":"auto",modelValue:o(t).code,"onUpdate:modelValue":e[1]||(e[1]=i=>o(t).code=i),density:"compact",label:"驗證碼","prepend-inner-icon":"mdi-lock-check",variant:"solo",required:"",rules:[a.codeRule],class:"register-item mb-2"},{label:s(()=>[...e[4]||(e[4]=[n("span",{class:"text-danger"},"*",-1),d("驗證碼 ",-1)])]),"append-inner":s(()=>[o(r)>0?(u(),c(g,{key:0,variant:"tonal",color:"primary",size:"small"},{default:s(()=>[n("p",$,f(o(r))+"秒 重新發送",1)]),_:1})):(u(),c(g,{key:1,onClick:e[0]||(e[0]=i=>N(a.query.email)),variant:"flat",color:"primary",size:"small"},{default:s(()=>[...e[5]||(e[5]=[n("p",{style:{"white-space":"nowrap",color:"white !important"}},"重新發送",-1)])]),_:1}))]),_:1},8,["modelValue","rules"]),v(g,{type:"submit",variant:"flat",color:"primary",block:"",class:"mt-5",loading:o(V)},{default:s(()=>[...e[6]||(e[6]=[d(" 驗證 ",-1)])]),_:1},8,["loading"]),e[9]||(e[9]=n("div",{class:"or"},"或",-1)),v(_,{to:"/sign-in",class:"text-decoration-none"},{default:s(()=>[...e[7]||(e[7]=[d("回登入",-1)])]),_:1})]),_:1},8,["modelValue"])}}},Q=M(A,[["__scopeId","data-v-c836e15d"]]);export{Q as default};
