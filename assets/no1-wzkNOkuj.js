import{H as V,f as k,D as y,b as h,o as f,d as c,y as I,u as v,F as U,x as K,aS as j,ac as oe,e as u,L as G,h as Q,ad as X,aY as ee,w as m,p as q,m as w,q as B,B as le,n as F,V as P,aF as ie,a3 as de,j as M,A as ce,a1 as ue,aZ as me,l as W,a_ as pe,v as fe,J as z}from"./index-Bs6z08K-.js";import{i as te,S as ge}from"./index-BM6j7F3b.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as ve,b as he,V as _e}from"./VCard-DsO6CZkH.js";import{V as H}from"./VAlert-CM7QDfYl.js";import{V as J,a as O}from"./VRow-CLYza5RD.js";/* empty css              */const Y=["目標設定","自信心","承諾","意象","心理練習","再專注","專注","比賽計畫","活化","放鬆","恐懼控制","壓力反應","自動化"],ae={基礎:{name:"基礎",btnColor:"#468FE1",bgColor:"linear-gradient(180deg, #6BC8F1 0%, #3885FD 100%)",indicators:{目標設定:0,自信心:0,承諾:0}},身心:{name:"身心",btnColor:"#9E6BE1",bgColor:"linear-gradient(180deg, #ECA2FF 0%, #9660F9 100%)",indicators:{意象:0,心理練習:0,再專注:0,專注:0}},認知:{name:"認知",btnColor:"#E28A8E",bgColor:"linear-gradient(180deg, #F98DAF 0%, #FFAF77 100%)",indicators:{比賽計畫:0,活化:0,放鬆:0,恐懼控制:0,壓力反應:0}},腦波:{name:"腦波",btnColor:"#468FE1",bgColor:"linear-gradient(180deg, #32CA09 0%, #C3E632 100%)",indicators:{自動化:0}}},Z=["基礎","身心","認知","腦波"],A={INDICATOR:"indicator",SKILL:"skill"},be={class:"header-section pb-3"},ye={class:"skill-name"},De={class:"average-score"},xe={class:"indicators-grid"},Ce=["onClick"],ke={class:"indicator-name"},Se={class:"indicator-score"},Ie={__name:"skillBlock",props:{skillName:{type:String,required:!0}},emits:["indicator-click"],setup(C,{emit:o}){const r=V("latestDatas"),s=k([]),p=C,i=o,e=y(()=>{if(Object.keys(r.value).length>0||r.value.date){const l=ae[p.skillName],g={...l,indicators:{}};for(const n in l.indicators)g.indicators[n]=r.value.indicators[n];return g}return{bgColor:"red",btnColor:"red",indicators:{xxx:0},name:"基礎"}}),a=y(()=>{if(!e.value||!e.value.indicators||Object.keys(e.value.indicators).length===0)return-20;const l=Object.values(e.value.indicators).filter(n=>n>0);return l.reduce((n,t)=>n+t,0)/l.length}),_=l=>{const g=s.value.indexOf(l);g>-1?s.value.splice(g,1):s.value.push(l),i("indicator-click",l)};return(l,g)=>(f(),h("div",{class:"skill-container",style:j("background:"+v(e).bgColor),elevation:"2"},[c("div",be,[c("div",ye,I(C.skillName),1),c("div",De,I(v(a).toFixed(1)),1)]),c("div",xe,[(f(!0),h(U,null,K(v(e).indicators,(n,t)=>(f(),h("div",{key:t,class:oe(["indicator-btn",{"indicator-selected":v(s).includes(t)}]),style:j("background:"+v(e).btnColor),onClick:d=>_(t)},[c("div",ke,I(t),1),c("div",Se,I(n),1)],14,Ce))),128))])],4))}},T=R(Ie,[["__scopeId","data-v-a9e3b51e"]]),we={class:"box bg-white"},$e={class:"right-up"},Ve={class:"d-flex ga-2"},Le={__name:"indicatorContainer",emits:["indicator-selected"],setup(C,{emit:o}){const r=V("latestDatas"),s=V("selectedIndicators"),p=o;y(()=>!r.datas||r.datas.length===0?!1:r.datas.some(e=>e.indicators?.自動化!==void 0||e.腦波圖));const i=e=>{const a=s.value.indexOf(e);a>-1?s.value.splice(a,1):s.value.push(e),p("indicator-selected",{indicator:e,selected:s.value.includes(e),allSelected:[...s.value]})};return(e,a)=>(f(),h("div",we,[a[0]||(a[0]=c("h3",null,"關鍵指標分數",-1)),c("div",$e,"最近測得日期"+I(v(r).date),1),c("div",Ve,[u(T,{"skill-name":"基礎",onIndicatorClick:i}),u(T,{"skill-name":"身心",onIndicatorClick:i}),u(T,{"skill-name":"認知",onIndicatorClick:i})])]))}},N=["#8fed93","#238adf","#FF9800","#9C27B0","#F44336","#04cae4","#248829","#FFEB3B","#607D8B","#795548","#f16895","#b4c1c6","#262f33"],Ee={class:"box bg-white"},ze={__name:"radarChart",setup(C){const o=V("selectedDates"),r=V("responseData"),s=k(A.INDICATOR),p=y(()=>r.datas&&r.datas.length>0&&o.value.length>0),i=k(null);let e=null;const a=y(()=>s.value===A.SKILL?Z.map(t=>({name:t,max:5})):Y.filter(t=>t!=="自動化").map(t=>({name:t,max:5}))),_=()=>!r.datas||r.datas.length===0?(console.log("no responseData"),[]):[...o.value].sort((d,b)=>new Date(d)-new Date(b)).map((d,b)=>{const x=r.datas.find(D=>D.date===d);if(!x)return null;let $=[];s.value===A.SKILL?$=Z.map(D=>{const L=ae[D],E=Object.keys(L.indicators);if(E.length===0)return 0;const se=E.reduce((ne,re)=>ne+(x.indicators[re]||0),0);return Math.round(se/E.length*100)/100}):$=Y.filter(D=>D!=="自動化").map(D=>x.indicators[D]||0);const S=N[b%N.length];return{name:d,value:$,itemStyle:{color:S},lineStyle:{color:S,width:2},areaStyle:{color:S,opacity:.15},symbol:"circle",symbolSize:6}}).filter(d=>d!==null),l=()=>{if(!e){console.log("Chart instance not initialized");return}if(!p.value){console.log("No Data"),e.clear(),e.setOption({title:{text:"沒有資料",left:"center",top:"middle",textStyle:{color:"#999",fontSize:20}}});return}const t={tooltip:{trigger:"item",backgroundColor:"rgba(50, 50, 50, 0.9)",borderColor:"#ccc",borderWidth:1,textStyle:{color:"#fff",fontSize:12},formatter:function(d){const{name:b,value:x,color:$}=d;let S=`<div style="margin-bottom: 8px;"><strong style="color: ${$};">${b}</strong></div>`;return a.value.forEach((D,L)=>{const E=x[L];S+=`<div style="margin: 2px 0;">${D.name}: <strong>${E}</strong></div>`}),S}},legend:{data:o.value,top:10,textStyle:{fontSize:14},itemGap:20,selectedMode:"multiple"},radar:{indicator:a.value,center:["50%","55%"],radius:"70%",axisName:{fontSize:12,color:"#666"},splitLine:{lineStyle:{color:"#e0e0e0"}},axisLine:{lineStyle:{color:"#ccc"}},splitArea:{show:!0,areaStyle:{color:["rgba(250,250,250,0.1)","rgba(200,200,200,0.1)"]}}},series:[{type:"radar",data:_(),symbol:"circle",symbolSize:6,lineStyle:{width:2}}]};e.setOption(t,!0)},g=()=>{e=te(i.value),l()};G([()=>r.datas,o,s],()=>{e&&l()},{deep:!0});const n=()=>{e&&e.resize()};return Q(()=>{X(()=>{g()}),window.addEventListener("resize",n)}),ee(()=>{e&&(e.dispose(),e=null),window.removeEventListener("resize",n)}),(t,d)=>(f(),h("div",Ee,[u(le,{modelValue:v(s),"onUpdate:modelValue":d[0]||(d[0]=b=>B(s)?s.value=b:null),mandatory:"",color:"primary",border:""},{default:m(()=>[u(q,{value:v(A).INDICATOR,size:"small"},{default:m(()=>[...d[1]||(d[1]=[w(" 向度 ",-1)])]),_:1},8,["value"]),u(q,{value:v(A).SKILL,size:"small"},{default:m(()=>[...d[2]||(d[2]=[w(" 技能 ",-1)])]),_:1},8,["value"])]),_:1},8,["modelValue"]),c("div",{ref_key:"chartContainer",ref:i,class:"chart-container"},null,512)]))}},Oe=R(ze,[["__scopeId","data-v-ff5450a8"]]),Ae={key:0,class:"brain-images"},Fe={class:"brain-image-header"},Be={class:"brain-image-date"},Ne={key:0,class:"brain-image-score"},Re={class:"brain-image-container"},Te={class:"d-flex align-center justify-center fill-height"},je={key:0,class:"no-brain-data"},Pe={__name:"brainImages",props:{responseData:{type:Object,default:()=>({userid:"",datas:[]})},selectedDates:{type:Array,default:()=>[]}},setup(C){const o=C,r=y(()=>o.responseData?.datas?o.responseData.datas.filter(e=>{const a=e.腦波圖&&e.腦波圖.trim()!=="",_=o.selectedDates.length===0||o.selectedDates.includes(e.date);return a&&_}).map(e=>({date:e.date,imagePath:e.腦波圖,score:e.indicators?.自動化||null})).sort((e,a)=>new Date(a.date)-new Date(e.date)):[]),s=y(()=>r.value.length>0),p=i=>{console.warn("腦波圖片載入失敗:",i.target.src),i.target.style.display="none"};return(i,e)=>s.value?(f(),h("div",Ae,[u(_e,{class:"brain-images-card",elevation:"2"},{default:m(()=>[u(ve,{class:"brain-images-title"},{default:m(()=>[u(P,{class:"mr-2",color:"purple"},{default:m(()=>[...e[0]||(e[0]=[w("mdi-brain",-1)])]),_:1}),e[1]||(e[1]=w(" 腦波測量結果 ",-1))]),_:1}),u(he,{class:"brain-images-content"},{default:m(()=>[(f(!0),h(U,null,K(r.value,a=>(f(),h("div",{key:a.date,class:"brain-image-item"},[c("div",Fe,[c("span",Be,I(a.date),1),a.score?(f(),h("span",Ne," 分數: "+I(a.score),1)):F("",!0)]),c("div",Re,[u(ie,{src:a.imagePath,alt:`腦波圖 - ${a.date}`,class:"brain-image","aspect-ratio":16/9,cover:"",onError:p},{placeholder:m(()=>[c("div",Te,[u(de,{color:"purple",indeterminate:""})])]),_:1},8,["src","alt"])])]))),128)),r.value.length===0?(f(),h("div",je,[u(P,{size:"48",color:"grey-lighten-1"},{default:m(()=>[...e[2]||(e[2]=[w("mdi-image-off",-1)])]),_:1}),e[3]||(e[3]=c("p",{class:"text-grey-lighten-1 mt-2"},"目前沒有腦波圖片資料",-1))])):F("",!0)]),_:1})]),_:1})])):F("",!0)}},Me=R(Pe,[["__scopeId","data-v-91580488"]]),Ue={class:"box bg-white"},Ke={__name:"trendChart",setup(C){const o=V("responseData"),r=k(null);let s=null;const p=y(()=>o?.datas&&o.datas.length>0),i=()=>!o?.datas||o.datas.length===0?[]:Object.keys(o.datas[0].indicators),e=()=>{if(!o?.datas||o.datas.length===0)return[];const l=i(),g=[...o.datas].sort((n,t)=>new Date(n.date)-new Date(t.date));return l.map((n,t)=>{const d=g.map(x=>[x.date,x.indicators[n]||0]),b=N[t%N.length];return{name:n,type:"line",data:d,smooth:!0,symbol:"circle",symbolSize:6,lineStyle:{width:2,color:b},itemStyle:{color:b}}})},a=()=>{r.value&&(s=te(r.value),_())},_=()=>{if(!s){console.log("Chart instance not initialized");return}if(!p.value){console.log("No Data"),s.clear(),s.setOption({title:{text:"No Data",left:"center",top:"middle",textStyle:{color:"#999",fontSize:20}}});return}const l=e(),g=i(),n={tooltip:{trigger:"axis",formatter:function(t){if(!t||t.length===0)return"";let b=`<strong>${t[0].axisValue}</strong><br/>`;return t.forEach(x=>{const{seriesName:$,value:S,color:D}=x,L=S[1];b+=`<span style="display: inline-block; width: 10px; height: 10px; background-color: ${D}; border-radius: 50%; margin-right: 5px;"></span>${$}: <strong>${L}</strong><br/>`}),b}},legend:{data:g,top:0,right:20},grid:{left:20,right:20,bottom:40,top:66},xAxis:{type:"category",boundaryGap:!1,axisLine:{lineStyle:{color:"#999"}},axisLabel:{color:"#666"},splitLine:{show:!0,lineStyle:{color:"#e5e5e5",type:"dashed"}}},yAxis:{type:"value",min:0,max:5,interval:1,axisLine:{show:!1},axisLabel:{color:"#666",fontSize:16},splitLine:{lineStyle:{color:"#e5e5e5",type:"dashed"}}},series:l};s.setOption(n,!0)};return G(o,()=>{s&&p.value&&_()},{deep:!0}),Q(()=>{X(()=>{a()});const l=()=>{s&&s.resize()};window.addEventListener("resize",l),ee(()=>{s&&(s.dispose(),s=null),window.removeEventListener("resize",l)})}),(l,g)=>(f(),h("div",Ue,[g[0]||(g[0]=c("h3",null,"各向度趨勢分析",-1)),c("div",{ref_key:"chartContainer",ref:r,class:"chart-container"},null,512)]))}},Ge=R(Ke,[["__scopeId","data-v-b167c300"]]),qe={class:"box bg-white"},We={key:0,class:"text-body-1 mb-2"},He={key:1,class:"text-body-1 mb-2"},Je={class:"pl-6"},Ye={__name:"recommendationPanel",setup(C){const o=V("responseData"),r=k(""),s=y(()=>o?.datas?o.datas.map(e=>e.date).sort((e,a)=>new Date(a)-new Date(e)):[]),p=y(()=>{if(!r.value||!o?.datas)return null;const e=o.datas.find(l=>l.date===r.value);if(!e?.indicators)return null;const a=Object.entries(e.indicators).filter(([l])=>l!=="自動化").map(([,l])=>l);return a.length===0?null:a.reduce((l,g)=>l+g,0)/a.length}),i=y(()=>p.value===null?[]:p.value<3.6?["請檢視你的微目標(Process Goals)，專注於「今天能做到的事」，而非最終結果，能有效建立信心和掌控感。","練習傾聽身體的聲音與放鬆技巧，不僅是看見，還要感覺、聽見成功的技術動作，強化肌肉與心靈的連結。","運用有力量的自我對話，例如：「我只有現在」、「Nice」，在突發狀況下，中斷負面思維的循環。建立例行動作幫助自己從比賽結果轉向任務執行過程。"]:["充滿意義的生活，繼續保持自信跟積極的投入，也要記得休息與心理恢復唷！","已具備良好的情緒調節能力，賽前調整很有一套唷！","頭腦清楚，戰術明確，專注於致勝關鍵的行動！"]);return G(s,e=>{e.length>0&&!r.value&&(r.value=e[0])},{immediate:!0}),(e,a)=>(f(),h("div",qe,[a[4]||(a[4]=c("h3",null,"心理指標建議",-1)),u(ce,{modelValue:v(r),"onUpdate:modelValue":a[0]||(a[0]=_=>B(r)?r.value=_:null),items:v(s),label:"選擇查看日期",variant:"outlined",density:"compact","prepend-inner-icon":"mdi-calendar","max-width":"180",class:"mt-2 right-up","hide-details":""},null,8,["modelValue","items"]),v(r)&&v(p)!==null?(f(),M(H,{key:0,prominent:"",class:"mt-6",style:j({backgroundColor:v(p)<3.6?"rgba(255, 235, 59, .3)":"rgba(76, 175, 80, .6)"})},{default:m(()=>[v(p)<3.6?(f(),h("p",We,[...a[1]||(a[1]=[c("strong",null,"建議改善方向：",-1)])])):(f(),h("p",He,[...a[2]||(a[2]=[c("strong",null,"保持優秀表現：",-1)])])),c("ul",Je,[(f(!0),h(U,null,K(v(i),(_,l)=>(f(),h("li",{key:l,class:"mb-2"},I(_),1))),128))])]),_:1},8,["style"])):(f(),M(H,{key:1,type:"info",variant:"outlined",class:"text-center"},{default:m(()=>[...a[3]||(a[3]=[w(" 請選擇日期以查看建議資訊 ",-1)])]),_:1}))]))}},Ze={key:0,class:"flex pa-4"},rt={__name:"no1",setup(C){const o=k("user123"),r=k("2025-10-20"),s=k(),p=k([]),i=ue({userid:"",datas:[]}),e=y(()=>i.datas.length===0?{}:[...i.datas].sort((t,d)=>new Date(d.date)-new Date(t.date))[0]||{}),a=y(()=>{if(i.datas.length===0)return null;const n=i.datas.find(t=>t.腦波圖);return n?{date:n.date,score:n.indicators?.自動化||null,imagePath:n.腦波圖}:null}),_=async()=>{try{const n=new URLSearchParams;s.value&&s.value.length>0&&s.value.forEach(b=>{n.append("date",b)});const t=n.toString(),d=await me.getIndicators(o.value,t);d.data?(i.userid=d.data.userid,i.datas=d.data.datas||[]):(console.error("API 回傳資料格式錯誤:",d),i.userid="",i.datas=[])}catch(n){console.error("獲取數據失敗:",n),i.userid="",i.datas=[]}},l=async()=>{await _(),s.value=i.datas.map(n=>n.date).sort((n,t)=>new Date(t)-new Date(n))},g=n=>{const t=p.value.indexOf(n);t>-1?p.value.splice(t,1):p.value.push(n)};return z("latestDatas",e),z("selectedIndicators",p),z("selectedDates",s),z("responseData",i),z("brainData",a),(n,t)=>(f(),h("div",null,[u(ge,{onSearch:l},{icon:m(()=>[u(P,null,{default:m(()=>[...t[2]||(t[2]=[w("mdi-mother-heart",-1)])]),_:1})]),title:m(()=>[...t[3]||(t[3]=[w(" 生理監控 ",-1)])]),default:m(()=>[t[5]||(t[5]=c("select",null,[c("option",null,"疲勞監控與身體組成分析")],-1)),t[6]||(t[6]=c("select",null,[c("option",null,"網球隊")],-1)),W(c("select",{"onUpdate:modelValue":t[0]||(t[0]=d=>B(o)?o.value=d:null)},[...t[4]||(t[4]=[c("option",{value:"user123"},"測試用戶1 (user123)",-1),c("option",{value:"user456"},"測試用戶2 (user456)",-1)])],512),[[pe,v(o)]]),W(c("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=d=>B(r)?r.value=d:null)},null,512),[[fe,v(r)]])]),_:1}),v(i).datas.length>0?(f(),h("section",Ze,[u(J,null,{default:m(()=>[u(O,{cols:"6"},{default:m(()=>[u(Le,{onIndicatorClick:g})]),_:1}),u(O,{cols:"6"},{default:m(()=>[u(Oe),v(a)?(f(),M(O,{key:0,cols:"12"},{default:m(()=>[u(Me)]),_:1})):F("",!0)]),_:1})]),_:1}),u(J,null,{default:m(()=>[u(O,{cols:"6"},{default:m(()=>[u(Ge)]),_:1}),u(O,{cols:"6"},{default:m(()=>[u(Ye)]),_:1})]),_:1})])):F("",!0)]))}};export{rt as default};
