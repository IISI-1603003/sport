import{K as R,z as Q,J as W,M as X,P as T,Z as Y,L as h,e as a,a2 as I,T as L,a3 as ee,a4 as ae,d as V,y as B,f as y,j as S,w as s,o as g,m as u,n as le,u as o,x as A,t as F,a as se}from"./index-YoOYIYhl.js";import{V as te}from"./VContainer-D58O2fyo.js";import{V as oe,a as ne}from"./VRow-D6SN89O4.js";import{V as D,a as re,b as M,c as ie,e as ue}from"./VCard-BoE4UQs3.js";import{t as de,k as ce,x as me,p as fe,G as ve,H as ye,q as Ve,n as pe,m as we,a as Pe,c as ke,I as be,J as Se,d as ge,y as Ce,e as xe,f as ze,w as _e,V as $,l as q}from"./index-C7nfzMpl.js";import{V as Te}from"./VForm-DES7YcTN.js";import{V as C}from"./VTextField-Ct49Ao8i.js";import{c as Ie}from"./VAvatar-DEknT8tg.js";import{V as x}from"./VBtn-BoYJvvf3.js";import{V as Le}from"./VSpacer-DddgVSoQ.js";import{a as Be,b as w,d as P}from"./VList-C4kwG3hb.js";/* empty css              */import"./forwardRefs-B9O2pm3w.js";import"./index-BfXC6dQ1.js";const Ae=Ie("v-alert-title"),Fe=R({iconSize:[Number,String],iconSizes:{type:Array,default:()=>[["x-small",10],["small",16],["default",24],["large",28],["x-large",32]]}},"iconSize");function De(e,v){return{iconSize:Q(()=>{const t=new Map(e.iconSizes),n=e.iconSize??v()??"default";return t.has(n)?t.get(n):n})}}const Me=["success","info","warning","error"],qe=R({border:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["top","end","bottom","start"].includes(e)},borderColor:String,closable:Boolean,closeIcon:{type:ae,default:"$close"},closeLabel:{type:String,default:"$vuetify.close"},icon:{type:[Boolean,String,Function,Object],default:null},modelValue:{type:Boolean,default:!0},prominent:Boolean,title:String,text:String,type:{type:String,validator:e=>Me.includes(e)},...ze(),...xe(),...Ce(),...ge(),...Fe(),...Se(),...be(),...ke(),...Pe(),...ee(),...we({variant:"flat"})},"VAlert"),N=W()({name:"VAlert",props:qe(),emits:{"click:close":e=>!0,"update:modelValue":e=>!0},setup(e,v){let{emit:m,slots:t}=v;const n=X(e,"modelValue"),d=T(()=>{if(e.icon!==!1)return e.type?e.icon??`$${e.type}`:e.icon}),{iconSize:r}=De(e,()=>e.prominent?44:void 0),{themeClasses:f}=Y(e),{colorClasses:k,colorStyles:p,variantClasses:i}=de(()=>({color:e.color??e.type,variant:e.variant})),{densityClasses:l}=ce(e),{dimensionStyles:c}=me(e),{elevationClasses:U}=fe(e),{locationStyles:j}=ve(e),{positionClasses:E}=ye(e),{roundedClasses:J}=Ve(e),{textColorClasses:O,textColorStyles:G}=pe(()=>e.borderColor),{t:H}=h(),z=T(()=>({"aria-label":H(e.closeLabel),onClick(b){n.value=!1,m("click:close",b)}}));return()=>{const b=!!(t.prepend||d.value),K=!!(t.title||e.title),Z=!!(t.close||e.closable),_={density:e.density,icon:d.value,size:e.iconSize||e.prominent?r.value:void 0};return n.value&&a(e.tag,{class:L(["v-alert",e.border&&{"v-alert--border":!!e.border,[`v-alert--border-${e.border===!0?"start":e.border}`]:!0},{"v-alert--prominent":e.prominent},f.value,k.value,l.value,U.value,E.value,J.value,i.value,e.class]),style:I([p.value,c.value,j.value,e.style]),role:"alert"},{default:()=>[_e(!1,"v-alert"),e.border&&V("div",{key:"border",class:L(["v-alert__border",O.value]),style:I(G.value)},null),b&&V("div",{key:"prepend",class:"v-alert__prepend"},[t.prepend?a(q,{key:"prepend-defaults",disabled:!d.value,defaults:{VIcon:{..._}}},t.prepend):a($,B({key:"prepend-icon"},_),null)]),V("div",{class:"v-alert__content"},[K&&a(Ae,{key:"title"},{default:()=>[t.title?.()??e.title]}),t.text?.()??e.text,t.default?.()]),t.append&&V("div",{key:"append",class:"v-alert__append"},[t.append()]),Z&&V("div",{key:"close",class:"v-alert__close"},[t.close?a(q,{key:"close-defaults",defaults:{VBtn:{icon:e.closeIcon,size:"x-small",variant:"text"}}},{default:()=>[t.close?.({props:z.value})]}):a(x,B({key:"close-btn",icon:e.closeIcon,size:"x-small",variant:"text"},z.value),null)])]})}}}),Xe={__name:"changePassword",setup(e){const v=y(),m=y(!1),t=y(!1),n=y(""),d=y(""),r=y({currentPassword:"",newPassword:"",confirmPassword:""}),f={required:i=>!!i||"此欄位為必填",minLength:i=>i&&i.length>=8||"密碼長度至少8個字元",passwordMatch:i=>i===r.value.newPassword||"密碼確認不相符"},k=async()=>{if(m.value){t.value=!0,n.value="",d.value="";try{await se.put("/api/profile/change-password",{currentPassword:r.value.currentPassword,newPassword:r.value.newPassword}),d.value="密碼已成功變更",p()}catch(i){n.value=i.response?.data?.message||"密碼變更失敗"}finally{t.value=!1}}},p=()=>{r.value={currentPassword:"",newPassword:"",confirmPassword:""},v.value?.reset(),n.value="",d.value=""};return(i,l)=>(g(),S(te,{fluid:""},{default:s(()=>[a(oe,null,{default:s(()=>[a(ne,{cols:"12",md:"6","offset-md":"3"},{default:s(()=>[a(D,null,{default:s(()=>[a(re,null,{default:s(()=>[a($,{class:"me-2"},{default:s(()=>[...l[4]||(l[4]=[u("mdi-key-change",-1)])]),_:1}),l[5]||(l[5]=u(" 密碼修改 ",-1))]),_:1}),a(M,null,{default:s(()=>[a(Te,{ref_key:"form",ref:v,modelValue:o(m),"onUpdate:modelValue":l[3]||(l[3]=c=>le(m)?m.value=c:null)},{default:s(()=>[a(C,{modelValue:o(r).currentPassword,"onUpdate:modelValue":l[0]||(l[0]=c=>o(r).currentPassword=c),label:"目前密碼",type:"password",rules:[f.required],variant:"outlined",class:"mb-4"},null,8,["modelValue","rules"]),a(C,{modelValue:o(r).newPassword,"onUpdate:modelValue":l[1]||(l[1]=c=>o(r).newPassword=c),label:"新密碼",type:"password",rules:[f.required,f.minLength],variant:"outlined",class:"mb-4"},null,8,["modelValue","rules"]),a(C,{modelValue:o(r).confirmPassword,"onUpdate:modelValue":l[2]||(l[2]=c=>o(r).confirmPassword=c),label:"確認新密碼",type:"password",rules:[f.required,f.passwordMatch],variant:"outlined",class:"mb-4"},null,8,["modelValue","rules"]),o(n)?(g(),S(N,{key:0,type:"error",class:"mb-4"},{default:s(()=>[u(F(o(n)),1)]),_:1})):A("",!0),o(d)?(g(),S(N,{key:1,type:"success",class:"mb-4"},{default:s(()=>[u(F(o(d)),1)]),_:1})):A("",!0)]),_:1},8,["modelValue"])]),_:1}),a(ie,null,{default:s(()=>[a(Le),a(x,{onClick:p},{default:s(()=>[...l[6]||(l[6]=[u("清除",-1)])]),_:1}),a(x,{color:"primary",disabled:!o(m)||o(t),loading:o(t),onClick:k},{default:s(()=>[...l[7]||(l[7]=[u(" 變更密碼 ",-1)])]),_:1},8,["disabled","loading"])]),_:1})]),_:1}),a(D,{class:"mt-4"},{default:s(()=>[a(ue,null,{default:s(()=>[...l[8]||(l[8]=[u("密碼安全建議",-1)])]),_:1}),a(M,null,{default:s(()=>[a(Be,{density:"compact"},{default:s(()=>[a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[9]||(l[9]=[u("密碼長度至少8個字元",-1)])]),_:1})]),_:1}),a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[10]||(l[10]=[u("包含大小寫字母",-1)])]),_:1})]),_:1}),a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[11]||(l[11]=[u("包含數字",-1)])]),_:1})]),_:1}),a(w,{"prepend-icon":"mdi-check-circle",color:"success"},{default:s(()=>[a(P,null,{default:s(()=>[...l[12]||(l[12]=[u("包含特殊符號",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}};export{Xe as default};
