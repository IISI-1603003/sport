{"version":3,"file":"registerStep2-R_cM4xw3.js","sources":["../../src/views/signIn/registerStep2.vue"],"sourcesContent":["<template>\r\n  <v-form @submit.prevent=\"submit\" v-model=\"valid\" class=\"mx-auto register-form\">\r\n    <h2 class=\"text-center mb-3\">一般帳號註冊</h2>\r\n\r\n    <div v-for=\"(value, key) in info\" :key=\"key\" class=\"label-container text-start mt-3\">\r\n      <span class=\"label-item\">{{ getLabel(key) }}</span> <span class=\"label-item\">{{ value }}</span>\r\n    </div>\r\n    <v-text-field hide-details=\"auto\" v-model=\"form.reason\" density=\"compact\" label=\"申請原因\"\r\n      prepend-inner-icon=\"mdi-information\" variant=\"solo\" required class=\"register-item mb-2\">\r\n      <template #label>\r\n        申請原因\r\n      </template>\r\n    </v-text-field>\r\n    <v-text-field hide-details=\"auto\" v-model=\"form.pw\" :type=\"showPw ? 'text' : 'password'\" density=\"compact\"\r\n      label=\"密碼\" prepend-inner-icon=\"mdi-lock\" variant=\"solo\" required class=\"register-item mb-2\" :rules=\"[pwRule]\">\r\n      <template #label>\r\n        <span class=\"text-danger\">*</span>密碼\r\n      </template>\r\n      <template #append-inner>\r\n        <v-icon @click=\"letPwVisible\" class=\"cursor-pointer\">\r\n          {{ showPw ? 'mdi-eye' : 'mdi-eye-off' }}\r\n        </v-icon>\r\n      </template>\r\n    </v-text-field>\r\n    <v-text-field hide-details=\"auto\" v-model=\"form.pwConfirm\" :type=\"showConfirmPw ? 'text' : 'password'\"\r\n      density=\"compact\" label=\"確認密碼\" prepend-inner-icon=\"mdi-lock-check\" variant=\"solo\" required\r\n      :rules=\"[value => pwConfirmRule(form.pw, value)]\" class=\"register-item mb-2\">\r\n      <template #label>\r\n        <span class=\"text-danger\">*</span>確認密碼\r\n      </template>\r\n      <template #append-inner>\r\n        <v-icon @click=\"letConfirmPwVisible\" class=\"cursor-pointer\">\r\n          {{ showConfirmPw ? 'mdi-eye' : 'mdi-eye-off' }}\r\n        </v-icon>\r\n      </template>\r\n    </v-text-field>\r\n    <v-btn type=\"submit\" variant=\"flat\" color=\"primary\" block class=\"mt-5\" :loading=\"loading\">\r\n      註冊\r\n    </v-btn>\r\n\r\n    <div class=\"or\">或</div>\r\n    <router-link to=\"/sign-in\" class=\"text-decoration-none\">回登入</router-link>\r\n  </v-form>\r\n</template>\r\n\r\n<script setup>\r\nimport { authentication } from \"@/requests\";\r\nimport { alertError } from \"@/helpers/functions\";\r\nimport { useReCaptcha } from \"vue-recaptcha-v3\";\r\nimport { pwRule, pwConfirmRule, userNumberRule, emailRule, nameRule } from \"@/rules\";\r\nimport { email } from \"../../rules\";\r\n\r\nconst router = useRouter();\r\nconst { executeRecaptcha } = useReCaptcha();\r\n\r\nconst loading = ref(false);\r\nconst valid = ref(true);\r\nconst error = ref(\"\");\r\nconst showPw = ref(false);\r\nconst showConfirmPw = ref(false);\r\nconst units = ref([\r\n  \"運動科學中心\",\r\n  \"健康促進與運動\",\r\n  \"廠商-資拓\",\r\n  \"體育器材研發\",\r\n  \"運動營養學\",\r\n  \"運動心理學\",\r\n  \"體適能測試\",\r\n  \"運動生物力學\",\r\n  \"運動傷害預防\",\r\n  \"運動恢復技術\",\r\n  \"健身房經營管理\",\r\n  \"團隊運動訓練\",\r\n  \"個人健身教練培訓\",\r\n  \"社區運動活動\",\r\n  \"運動科技創新\"\r\n]);\r\nconst form = ref({\r\n  userName: \"\",\r\n  name: \"\",\r\n  email: \"\",\r\n  gender: \"\",\r\n  unit: \"\",\r\n  reason: \"\",\r\n  pw: \"\",\r\n  pwConfirm: \"\"\r\n});\r\nconst info = ref({\r\n  userName: \"\",\r\n  name: \"\",\r\n  gender: \"\",\r\n  email: \"\",\r\n  unit: \"\",\r\n});\r\nconst labels = {\r\n  userName: \"帳號/員工編號\",\r\n  name: \"姓名\",\r\n  gender: \"性別\",\r\n  email: \"信箱\",\r\n  unit: \"單位\",\r\n};\r\n\r\nonMounted(() => {\r\n  const query = router.currentRoute.value.query;\r\n  //顯示\r\n  info.value.userName = query.userName || \"\";\r\n  info.value.name = query.name || \"\";\r\n  info.value.gender = query.gender;\r\n  info.value.email = query.email || \"\";\r\n  info.value.unit = query.unit;\r\n  //表單\r\n  form.value.userName = query.userName;\r\n  form.value.name = query.name;\r\n  form.value.email = query.email;\r\n  form.value.gender = query.gender;\r\n  form.value.unit = query.unit;\r\n});\r\n\r\nconst getLabel = (key) => labels[key] || key;\r\n\r\nfunction letPwVisible() {\r\n  showPw.value = !showPw.value;\r\n}\r\nfunction letConfirmPwVisible() {\r\n  showConfirmPw.value = !showConfirmPw.value;\r\n}\r\n\r\n\r\nconst submit = async () => {\r\n  const rules = {\r\n    pw: pwRule,\r\n    pwConfirm: value => pwConfirmRule(form.value.pw, value),\r\n    userName: userNumberRule,\r\n    email: emailRule,\r\n    name: nameRule,\r\n  };\r\n\r\n  for (const key in rules) {\r\n    const rule = rules[key];\r\n    if (form.value[key] !== undefined) {\r\n      const result = rule(form.value[key]);\r\n      if (result !== true) {\r\n        alert(`${result}`);\r\n        return;\r\n      }\r\n    }\r\n  }\r\n  loading.value = true;\r\n  try {\r\n    const token = await executeRecaptcha(\"signUp\");\r\n    await authentication.signUp({\r\n      userName: form.value.userName,\r\n      name: form.value.name,\r\n      email: form.value.email,\r\n      gender: form.value.gender,\r\n      unit: form.value.unit,\r\n      reason: form.value.reason,\r\n      pw: form.value.pw\r\n    }, { headers: { token } }).then(a => {\r\n      router.push({\r\n        path: '/sign-in/registerSuccess', query: {}\r\n      });\r\n      loading.value = false;\r\n    }).catch(e => {\r\n      alertError(e);\r\n      loading.value = false;\r\n    });\r\n  } catch (e) {\r\n    alertError(e);\r\n  } finally {\r\n    loading.value = false;\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.register-form {\r\n  min-width: 60%;\r\n}\r\n\r\n.register-item {\r\n  border-radius: 10px !important;\r\n  margin-top: 18px;\r\n}\r\n\r\n.register-item .v-field {\r\n  height: 25px;\r\n}\r\n\r\n.register-item .v-input__control {\r\n  box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.5) !important;\r\n  background-color: white;\r\n}\r\n\r\n:global(.right .register-item .v-input__details .v-messages__message) {\r\n  color: lightcoral !important;\r\n}\r\n\r\n:global(.register-item .v-field) {\r\n  border-radius: 10px !important;\r\n}\r\n\r\n:global(.right .register-item .v-input__control *) {\r\n  color: gray !important;\r\n}\r\n\r\n:global(.right .register-item .text-danger) {\r\n  color: red !important;\r\n}\r\n\r\n.label-container {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  min-width: 280px;\r\n}\r\n\r\n.label-item {\r\n  flex: 1;\r\n  min-width: 100px;\r\n}\r\n</style>"],"names":["router","useRouter","executeRecaptcha","useReCaptcha","loading","ref","valid","showPw","showConfirmPw","form","info","labels","onMounted","query","getLabel","key","letPwVisible","letConfirmPwVisible","submit","rules","pwRule","value","pwConfirmRule","userNumberRule","emailRule","nameRule","rule","result","token","authentication","a","e","alertError","_createBlock","_component_v_form","_unref","$event","_cache","_createElementVNode","_openBlock","_createElementBlock","_Fragment","_renderList","_hoisted_1","_toDisplayString","_hoisted_2","_createVNode","_component_v_text_field","_component_v_icon","_component_v_btn","_component_router_link"],"mappings":"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"}